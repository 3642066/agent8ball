function l(a){throw a;}var o=true,r=null,s=false;function aa(){return function(){}}function ba(a){return function(){return this[a]}}function ca(a){return function(){return a}}var t,C=this;function da(a){a=a.split(".");for(var c=C,b;b=a.shift();)if(c[b]!=r)c=c[b];else return r;return c}function ea(){}
function fa(a){var c=typeof a;if(c=="object")if(a){if(a instanceof Array)return"array";else if(a instanceof Object)return c;var b=Object.prototype.toString.call(a);if(b=="[object Window]")return"object";if(b=="[object Array]"||typeof a.length=="number"&&typeof a.splice!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("splice"))return"array";if(b=="[object Function]"||typeof a.call!="undefined"&&typeof a.propertyIsEnumerable!="undefined"&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if(c=="function"&&typeof a.call=="undefined")return"object";return c}function ga(a){return fa(a)=="array"}function ha(a){var c=fa(a);return c=="array"||c=="object"&&typeof a.length=="number"}function D(a){return typeof a=="string"}function ia(a){return typeof a=="number"}function ja(a){return fa(a)=="function"}function Ja(a){a=fa(a);return a=="object"||a=="array"||a=="function"}function ma(a){return a[na]||(a[na]=++oa)}
var na="closure_uid_"+Math.floor(Math.random()*2147483648).toString(36),oa=0;function Ka(a){return a.call.apply(a.bind,arguments)}function Qa(a,c){var b=c||C;if(arguments.length>2){var d=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(e,d);return a.apply(b,e)}}else return function(){return a.apply(b,arguments)}}
function pa(){pa=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ka:Qa;return pa.apply(r,arguments)}function qa(a){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var ra=Date.now||function(){return+new Date};function E(a,c){function b(){}b.prototype=c.prototype;a.$superClass_$=c.prototype;a.prototype=new b};function sa(a){for(var c=1;c<arguments.length;c++){var b=String(arguments[c]).replace(/\$/g,"$$$$");a=a.replace(/\%s/,b)}return a}function ta(a){if(!Aa.test(a))return a;a.indexOf("&")!=-1&&(a=a.replace(ua,"&amp;"));a.indexOf("<")!=-1&&(a=a.replace(va,"&lt;"));a.indexOf(">")!=-1&&(a=a.replace(wa,"&gt;"));a.indexOf('"')!=-1&&(a=a.replace(za,"&quot;"));return a}var ua=/&/g,va=/</g,wa=/>/g,za=/\"/g,Aa=/[&<>\"]/;
function Ba(a,c){for(var b=0,d=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=String(c).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),f=Math.max(d.length,e.length),g=0;b==0&&g<f;g++){var h=d[g]||"",j=e[g]||"",i=RegExp("(\\d*)(\\D*)","g"),k=RegExp("(\\d*)(\\D*)","g");do{var n=i.exec(h)||["","",""],m=k.exec(j)||["","",""];if(n[0].length==0&&m[0].length==0)break;b=Ca(n[1].length==0?0:parseInt(n[1],10),m[1].length==0?0:parseInt(m[1],10))||Ca(n[2].length==0,m[2].length==0)||Ca(n[2],m[2])}while(b==
0)}return b}function Ca(a,c){if(a<c)return-1;else if(a>c)return 1;return 0}var Ta={};function Ua(a){return Ta[a]||(Ta[a]=String(a).replace(/\-([a-z])/g,function(c,b){return b.toUpperCase()}))};var Da,Ea,Fa,Ga,Ha;function Ia(){return C.navigator?C.navigator.userAgent:r}Ga=Fa=Ea=Da=s;var Va;if(Va=Ia()){var Wa=C.navigator;Da=Va.indexOf("Opera")==0;Ea=!Da&&Va.indexOf("MSIE")!=-1;Fa=!Da&&Va.indexOf("WebKit")!=-1;Ga=!Da&&!Fa&&Wa.product=="Gecko"}var La=Da,Ma=Ea,Na=Ga,Oa=Fa,Pa,Xa=C.navigator;Pa=Xa&&Xa.platform||"";Ha=Pa.indexOf("Mac")!=-1;var Ra=Pa.indexOf("Win")!=-1,Sa;
a:{var Ya="",ab;if(La&&C.opera){var bb=C.opera.version;Ya=typeof bb=="function"?bb():bb}else{if(Na)ab=/rv\:([^\);]+)(\)|;)/;else if(Ma)ab=/MSIE\s+([^\);]+)(\)|;)/;else Oa&&(ab=/WebKit\/(\S+)/);if(ab){var cb=ab.exec(Ia());Ya=cb?cb[1]:""}}if(Ma){var db,eb=C.document;db=eb?eb.documentMode:undefined;if(db>parseFloat(Ya)){Sa=String(db);break a}}Sa=Ya}var Za={};function $a(a){return Za[a]||(Za[a]=Ba(Sa,a)>=0)};function mb(a){this.a=a}var rb=/\s*;\s*/;function Yb(a,c,b,d,e,f){/[;=\s]/.test(c)&&l(Error('Invalid cookie name "'+c+'"'));/[;\r\n]/.test(b)&&l(Error('Invalid cookie value "'+b+'"'));d!==undefined||(d=-1);f=f?";domain="+f:"";e=e?";path="+e:"";d=d<0?"":d==0?";expires="+(new Date(1970,1,1)).toUTCString():";expires="+(new Date(ra()+d*1E3)).toUTCString();a.a.cookie=c+"="+b+f+e+d+""}
mb.prototype.get=function(a,c){for(var b=a+"=",d=(this.a.cookie||"").split(rb),e=0,f;f=d[e];e++)if(f.indexOf(b)==0)return f.substr(b.length);return c};mb.prototype.remove=function(a,c,b){var d;d=this.get(a)!==undefined;Yb(this,a,"",0,c,b);return d};function od(a){a=(a.a.cookie||"").split(rb);for(var c=[],b=[],d,e,f=0;e=a[f];f++){d=e.indexOf("=");if(d==-1){c.push("");b.push(e)}else{c.push(e.substring(0,d));b.push(e.substring(d+1))}}return{$keys$:c,$values$:b}}var Hd=new mb(document);Hd.b=3950;function fb(a,c){c===undefined?Hd.remove(a):Yb(Hd,a,c,31536E4);hb()}function hb(){ib(od(Hd).$keys$,function(a){var c;a:{for(c in jb)if(jb[c]==a){c=o;break a}c=s}c||Hd.remove(a)})}var jb={$SOUND_EFFECTS$:"s",$MUSIC$:"m",$HIGH_SCORE$:"h"};function kb(a){this.stack=Error().stack||"";if(a)this.message=String(a)}E(kb,Error);kb.prototype.name="CustomError";function lb(a,c){c.unshift(a);kb.call(this,sa.apply(r,c));c.shift();this.$messagePattern$=a}E(lb,kb);lb.prototype.name="AssertionError";function nb(a){l(new lb("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1)))};var ob=Array.prototype,pb=ob.indexOf?function(a,c,b){return ob.indexOf.call(a,c,b)}:function(a,c,b){b=b==r?0:b<0?Math.max(0,a.length+b):b;if(D(a)){if(!D(c)||c.length!=1)return-1;return a.indexOf(c,b)}for(;b<a.length;b++)if(b in a&&a[b]===c)return b;return-1},ib=ob.forEach?function(a,c,b){ob.forEach.call(a,c,b)}:function(a,c,b){for(var d=a.length,e=D(a)?a.split(""):a,f=0;f<d;f++)f in e&&c.call(b,e[f],f,a)};function qb(a){if(!ga(a))for(var c=a.length-1;c>=0;c--)delete a[c];a.length=0}
function Jg(a,c){var b=pb(a,c),d;(d=b>=0)&&ob.splice.call(a,b,1);return d}function sb(a,c){var b;a:{b=a.length;for(var d=D(a)?a.split(""):a,e=0;e<b;e++)if(e in d&&c.call(void 0,d[e],e,a)){b=e;break a}b=-1}if(b>=0){ob.splice.call(a,b,1);return o}return s}function tb(){return ob.concat.apply(ob,arguments)}function Kg(a){if(ga(a))return tb(a);else{for(var c=[],b=0,d=a.length;b<d;b++)c[b]=a[b];return c}}function Lg(a,c,b){return arguments.length<=2?ob.slice.call(a,c):ob.slice.call(a,c,b)}
function ub(a,c){return a>c?1:a<c?-1:0};function vb(a,c){this.x=a!==undefined?a:0;this.y=c!==undefined?c:0}vb.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function F(a,c){this.x=a;this.y=c}E(F,vb);function I(a){return Math.sqrt(a.x*a.x+a.y*a.y)}F.prototype.scale=function(a){this.x*=a;this.y*=a;return this};F.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};F.prototype.$subtract$=function(a){this.x-=a.x;this.y-=a.y;return this};function wb(a,c){return a.x*c.x+a.y*c.y};function J(a,c){a===undefined&&(a=0);this.x=a;c===undefined&&(c=0);this.y=c}E(J,F);t=J.prototype;t.$SetZero$=function(){this.y=this.x=0};t.$Set$=function(a,c){this.x=a;this.y=c};function K(a,c){a.x=c.x;a.y=c.y}t.$Copy$=function(){return new J(this.x,this.y)};function xb(a,c){var b=a.x;a.x=c.$col1$.x*b+c.$col2$.x*a.y;a.y=c.$col1$.y*b+c.$col2$.y*a.y}t.$Abs$=function(){this.x=Math.abs(this.x);this.y=Math.abs(this.y)};function yb(a){var c=I(a);if(!(c<Number.MIN_VALUE)){c=1/c;a.x*=c;a.y*=c}}
t.$IsValid$=function(){return isFinite(this.x)&&isFinite(this.y)};function zb(a,c){return new J(a.x+c.x,a.y+c.y)}function Ab(a,c){return new J(a.x-c.x,a.y-c.y)};function Bb(){this.$minVertex$=new J;this.$maxVertex$=new J}Bb.prototype.$IsValid$=function(){var a=this.$maxVertex$.x,c=this.$maxVertex$.y;a=this.$maxVertex$.x;c=this.$maxVertex$.y;a-=this.$minVertex$.x;c-=this.$minVertex$.y;return a=a>=0&&c>=0&&this.$minVertex$.$IsValid$()&&this.$maxVertex$.$IsValid$()};var Cb=Math.PI,Db=2/180/1;function Ib(){this.type=-1;this.$userData$=r;this.$localPosition$=new J(0,0);this.$localRotation$=0;this.$friction$=0.2;this.$density$=this.$restitution$=0;this.$categoryBits$=1;this.$maskBits$=65535;this.$groupIndex$=0}Ib.prototype.c=function(a){a.$center$=new J(0,0);a.$mass$=0;a.$I$=0};Ib.prototype.$categoryBits$=0;Ib.prototype.$maskBits$=0;Ib.prototype.$groupIndex$=0;function Eb(){this.$shapes$=[];this.$userData$=r;for(var a=0;a<64;a++)this.$shapes$[a]=r;this.position=new J(0,0);this.rotation=0;this.$linearVelocity$=new J(0,0);this.$angularDamping$=this.$linearDamping$=this.$angularVelocity$=0;this.$allowSleep$=o;this.$preventRotation$=this.$isSleeping$=s}function Fb(a,c){for(var b=0;b<64;++b)if(a.$shapes$[b]==r){a.$shapes$[b]=c;break}};function Jb(){Ib.call(this);this.type=0;this.$radius$=1}E(Jb,Ib);Jb.prototype.c=function(a){a.$mass$=this.$density$*Cb*this.$radius$*this.$radius$;a.$I$=0.5*a.$mass$*this.$radius$*this.$radius$};function Kb(){Ib.call(this);this.$vertices$=Array(8);this.type=2;for(var a=this.$vertexCount$=0;a<8;a++)this.$vertices$[a]=new J}E(Kb,Ib);function Lb(a,c){a.$vertexCount$=c.length;for(var b=0;b<c.length;b++)a.$vertices$[b].$Set$(c[b][0],c[b][1])}
Kb.prototype.c=function(a){a.$center$=new J(0,0);if(this.$density$==0){a.$mass$=0;a.$center$.$Set$(0,0);a.$I$=0}var c=this.$vertices$,b=this.$vertexCount$,d=this.$density$,e=new J;e.$SetZero$();for(var f=0,g=0,h=new J(0,0),j=1/3,i=0;i<b;++i){var k=h,n=c[i],m=i+1<b?c[i+1]:c[0],q=Ab(n,k),x=Ab(m,k),z=q.x*x.y-q.y*x.x,w=0.5*z;f+=w;var u=new J;K(u,k);u.add(n);u.add(m);u.scale(j*w);e.add(u);n=k.x;k=k.y;m=q.x;q=q.y;w=x.x;x=x.y;g+=z*(j*(0.25*(m*m+w*m+w*w)+(n*m+n*w))+0.5*n*n+(j*(0.25*(q*q+x*q+x*x)+(k*q+k*x))+
0.5*k*k))}a.$mass$=d*f;e.scale(1/f);a.$center$=e;g=d*(g-f*wb(e,e));a.$I$=g};function Mb(){this.$mass$=this.$I$=0;this.$center$=new J(0,0)};function L(a,c,b){a==r&&(a=0);this.$col1$=new J;this.$col2$=new J;if(c!=r&&b!=r){K(this.$col1$,c);K(this.$col2$,b)}else{c=Math.cos(a);a=Math.sin(a);this.$col1$.x=c;this.$col2$.x=-a;this.$col1$.y=a;this.$col2$.y=c}}t=L.prototype;t.$Set$=function(a){var c=Math.cos(a);a=Math.sin(a);this.$col1$.x=c;this.$col2$.x=-a;this.$col1$.y=a;this.$col2$.y=c};t.$Copy$=function(){return new L(0,this.$col1$,this.$col2$)};function Gb(a,c){K(a.$col1$,c.$col1$);K(a.$col2$,c.$col2$)}
t.$SetZero$=function(){this.$col1$.x=0;this.$col2$.x=0;this.$col1$.y=0;this.$col2$.y=0};t.$Solve$=function(a,c,b){var d=this.$col1$.x,e=this.$col2$.x,f=this.$col1$.y,g=this.$col2$.y,h;h=1/(d*g-e*f);a.x=h*(g*c-e*b);a.y=h*(d*b-f*c);return a};t.$Abs$=function(){this.$col1$.$Abs$();this.$col2$.$Abs$()};function Nb(a,c){return new J(a.$col1$.x*c.x+a.$col2$.x*c.y,a.$col1$.y*c.x+a.$col2$.y*c.y)};function Ob(a,c,b){this.$m_R$=new L;this.$m_position$=new J;this.$m_userData$=a.$userData$;this.$m_friction$=a.$friction$;this.$m_restitution$=a.$restitution$;this.$m_body$=c;this.$m_proxyId$=M;this.$m_maxRadius$=0;this.$categoryBits$=a.$categoryBits$;this.$maskBits$=a.$maskBits$;this.$m_groupIndex$=a.$groupIndex$;this.$m_localPosition$=new J;this.$m_localPosition$.$Set$(a.$localPosition$.x-b.x,a.$localPosition$.y-b.y);this.$m_type$=a.type;this.$m_radius$=a.$radius$;Gb(this.$m_R$,this.$m_body$.$m_R$);
a=this.$m_R$.$col1$.x*this.$m_localPosition$.x+this.$m_R$.$col2$.x*this.$m_localPosition$.y;c=this.$m_R$.$col1$.y*this.$m_localPosition$.x+this.$m_R$.$col2$.y*this.$m_localPosition$.y;this.$m_position$.x=this.$m_body$.$m_position$.x+a;this.$m_position$.y=this.$m_body$.$m_position$.y+c;this.$m_maxRadius$=Math.sqrt(a*a+c*c)+this.$m_radius$;a=new Bb;a.$minVertex$.$Set$(this.$m_position$.x-this.$m_radius$,this.$m_position$.y-this.$m_radius$);a.$maxVertex$.$Set$(this.$m_position$.x+this.$m_radius$,this.$m_position$.y+
this.$m_radius$);c=this.$m_body$.$m_world$.$m_broadPhase$;this.$m_proxyId$=Pb(c,a)?Qb(c,a,this):M;this.$m_proxyId$==M&&Rb(this.$m_body$)}E(Ob,Hb);
Ob.prototype.$Synchronize$=function(a,c,b,d){Gb(this.$m_R$,d);this.$m_position$.x=d.$col1$.x*this.$m_localPosition$.x+d.$col2$.x*this.$m_localPosition$.y+b.x;this.$m_position$.y=d.$col1$.y*this.$m_localPosition$.x+d.$col2$.y*this.$m_localPosition$.y+b.y;if(this.$m_proxyId$!=M){b=a.x+(c.$col1$.x*this.$m_localPosition$.x+c.$col2$.x*this.$m_localPosition$.y);c=a.y+(c.$col1$.y*this.$m_localPosition$.x+c.$col2$.y*this.$m_localPosition$.y);d=Math.max(b,this.$m_position$.x);var e=Math.max(c,this.$m_position$.y);
a=new Bb;a.$minVertex$.$Set$(Math.min(b,this.$m_position$.x)-this.$m_radius$,Math.min(c,this.$m_position$.y)-this.$m_radius$);a.$maxVertex$.$Set$(d+this.$m_radius$,e+this.$m_radius$);b=this.$m_body$.$m_world$.$m_broadPhase$;Pb(b,a)?Sb(b,this.$m_proxyId$,a):Rb(this.$m_body$)}};
Ob.prototype.$ResetProxy$=function(a){if(this.$m_proxyId$!=M){a.$DestroyProxy$(this.$m_proxyId$);var c=new Bb;c.$minVertex$.$Set$(this.$m_position$.x-this.$m_radius$,this.$m_position$.y-this.$m_radius$);c.$maxVertex$.$Set$(this.$m_position$.x+this.$m_radius$,this.$m_position$.y+this.$m_radius$);this.$m_proxyId$=Pb(a,c)?Qb(a,c,this):M;this.$m_proxyId$==M&&Rb(this.$m_body$)}};function Tb(){this.$R$=new L;this.$center$=new J;this.$extents$=new J};function Hb(a,c){this.$m_R$=new L;this.$m_position$=new J;this.$m_userData$=a.$userData$;this.$m_friction$=a.$friction$;this.$m_restitution$=a.$restitution$;this.$m_body$=c;this.$m_proxyId$=M;this.$m_maxRadius$=0;this.$categoryBits$=a.$categoryBits$;this.$maskBits$=a.$maskBits$;this.$m_groupIndex$=a.$groupIndex$}Hb.prototype.$ResetProxy$=aa();Hb.prototype.$GetNext$=ba("$m_next$");
Hb.prototype.$DestroyProxy$=function(){if(this.$m_proxyId$!=M){this.$m_body$.$m_world$.$m_broadPhase$.$DestroyProxy$(this.$m_proxyId$);this.$m_proxyId$=M}};Hb.prototype.$Synchronize$=aa();function Ub(a,c,b){this.$m_R$=new L;this.$m_position$=new J;this.$m_userData$=a.$userData$;this.$m_friction$=a.$friction$;this.$m_restitution$=a.$restitution$;this.$m_body$=c;this.$m_proxyId$=M;this.$m_maxRadius$=0;this.$categoryBits$=a.$categoryBits$;this.$maskBits$=a.$maskBits$;this.$m_groupIndex$=a.$groupIndex$;this.$syncAABB$=new Bb;this.$syncMat$=new L;this.$m_localCentroid$=new J;this.$m_localOBB$=new Tb;var d=0,e;c=new Bb;this.$m_vertices$=Array(8);this.$m_coreVertices$=Array(8);this.$m_normals$=
Array(8);this.$m_type$=2;var f=new L(a.$localRotation$);this.$m_vertexCount$=a.$vertexCount$;d=a.$vertices$;for(var g=a.$vertexCount$,h=0,j=e=0,i=1/3,k=0;k<g;++k){var n=d[k].x,m=d[k].y,q=k+1<g?d[k+1].x:d[0].x,x=k+1<g?d[k+1].y:d[0].y,z=0.5*((n-0)*(x-0)-(m-0)*(q-0));j+=z;h+=z*i*(0+n+q);e+=z*i*(0+m+x)}h*=1/j;e*=1/j;Vb.$Set$(h,e);g=Vb.x;h=Vb.y;this.$m_localCentroid$.x=a.$localPosition$.x+(f.$col1$.x*g+f.$col2$.x*h)-b.x;this.$m_localCentroid$.y=a.$localPosition$.y+(f.$col1$.y*g+f.$col2$.y*h)-b.y;for(d=
0;d<this.$m_vertexCount$;++d){this.$m_vertices$[d]=new J;this.$m_coreVertices$[d]=new J;b=a.$vertices$[d].x-g;e=a.$vertices$[d].y-h;this.$m_vertices$[d].x=f.$col1$.x*b+f.$col2$.x*e;this.$m_vertices$[d].y=f.$col1$.y*b+f.$col2$.y*e;b=this.$m_vertices$[d].x;e=this.$m_vertices$[d].y;j=Math.sqrt(b*b+e*e);if(j>Number.MIN_VALUE){b*=1/j;e*=1/j}this.$m_coreVertices$[d].x=this.$m_vertices$[d].x-0.3*b;this.$m_coreVertices$[d].y=this.$m_vertices$[d].y-0.3*e}f=a=Number.MAX_VALUE;b=-Number.MAX_VALUE;g=-Number.MAX_VALUE;
for(d=this.$m_maxRadius$=0;d<this.$m_vertexCount$;++d){h=this.$m_vertices$[d];a=Math.min(a,h.x);f=Math.min(f,h.y);b=Math.max(b,h.x);g=Math.max(g,h.y);this.$m_maxRadius$=Math.max(this.$m_maxRadius$,I(h))}d=this.$m_localOBB$.$R$;d.$col1$.x=1;d.$col2$.x=0;d.$col1$.y=0;d.$col2$.y=1;this.$m_localOBB$.$center$.$Set$((a+b)*0.5,(f+g)*0.5);this.$m_localOBB$.$extents$.$Set$((b-a)*0.5,(g-f)*0.5);for(d=f=a=0;d<this.$m_vertexCount$;++d){this.$m_normals$[d]=new J;a=d;f=d+1<this.$m_vertexCount$?d+1:0;this.$m_normals$[d].x=
this.$m_vertices$[f].y-this.$m_vertices$[a].y;this.$m_normals$[d].y=-(this.$m_vertices$[f].x-this.$m_vertices$[a].x);yb(this.$m_normals$[d])}for(d=0;d<this.$m_vertexCount$;++d);Gb(this.$m_R$,this.$m_body$.$m_R$);this.$m_position$.x=this.$m_body$.$m_position$.x+(this.$m_R$.$col1$.x*this.$m_localCentroid$.x+this.$m_R$.$col2$.x*this.$m_localCentroid$.y);this.$m_position$.y=this.$m_body$.$m_position$.y+(this.$m_R$.$col1$.y*this.$m_localCentroid$.x+this.$m_R$.$col2$.y*this.$m_localCentroid$.y);Wb.$col1$.x=
this.$m_R$.$col1$.x*this.$m_localOBB$.$R$.$col1$.x+this.$m_R$.$col2$.x*this.$m_localOBB$.$R$.$col1$.y;Wb.$col1$.y=this.$m_R$.$col1$.y*this.$m_localOBB$.$R$.$col1$.x+this.$m_R$.$col2$.y*this.$m_localOBB$.$R$.$col1$.y;Wb.$col2$.x=this.$m_R$.$col1$.x*this.$m_localOBB$.$R$.$col2$.x+this.$m_R$.$col2$.x*this.$m_localOBB$.$R$.$col2$.y;Wb.$col2$.y=this.$m_R$.$col1$.y*this.$m_localOBB$.$R$.$col2$.x+this.$m_R$.$col2$.y*this.$m_localOBB$.$R$.$col2$.y;Wb.$Abs$();b=Wb.$col1$.x*this.$m_localOBB$.$extents$.x+Wb.$col2$.x*
this.$m_localOBB$.$extents$.y;e=Wb.$col1$.y*this.$m_localOBB$.$extents$.x+Wb.$col2$.y*this.$m_localOBB$.$extents$.y;a=this.$m_position$.x+(this.$m_R$.$col1$.x*this.$m_localOBB$.$center$.x+this.$m_R$.$col2$.x*this.$m_localOBB$.$center$.y);f=this.$m_position$.y+(this.$m_R$.$col1$.y*this.$m_localOBB$.$center$.x+this.$m_R$.$col2$.y*this.$m_localOBB$.$center$.y);c.$minVertex$.x=a-b;c.$minVertex$.y=f-e;c.$maxVertex$.x=a+b;c.$maxVertex$.y=f+e;a=this.$m_body$.$m_world$.$m_broadPhase$;this.$m_proxyId$=Pb(a,
c)?Qb(a,c,this):M;this.$m_proxyId$==M&&Rb(this.$m_body$)}E(Ub,Hb);Ub.prototype.$syncAABB$=new Bb;Ub.prototype.$syncMat$=new L;
Ub.prototype.$Synchronize$=function(a,c,b,d){Gb(this.$m_R$,d);this.$m_position$.x=this.$m_body$.$m_position$.x+(d.$col1$.x*this.$m_localCentroid$.x+d.$col2$.x*this.$m_localCentroid$.y);this.$m_position$.y=this.$m_body$.$m_position$.y+(d.$col1$.y*this.$m_localCentroid$.x+d.$col2$.y*this.$m_localCentroid$.y);if(this.$m_proxyId$!=M){var e,f;e=c.$col1$;f=c.$col2$;var g=this.$m_localOBB$.$R$.$col1$,h=this.$m_localOBB$.$R$.$col2$;this.$syncMat$.$col1$.x=e.x*g.x+f.x*g.y;this.$syncMat$.$col1$.y=e.y*g.x+f.y*
g.y;this.$syncMat$.$col2$.x=e.x*h.x+f.x*h.y;this.$syncMat$.$col2$.y=e.y*h.x+f.y*h.y;this.$syncMat$.$Abs$();e=this.$m_localCentroid$.x+this.$m_localOBB$.$center$.x;f=this.$m_localCentroid$.y+this.$m_localOBB$.$center$.y;g=a.x+(c.$col1$.x*e+c.$col2$.x*f);a=a.y+(c.$col1$.y*e+c.$col2$.y*f);e=this.$syncMat$.$col1$.x*this.$m_localOBB$.$extents$.x+this.$syncMat$.$col2$.x*this.$m_localOBB$.$extents$.y;f=this.$syncMat$.$col1$.y*this.$m_localOBB$.$extents$.x+this.$syncMat$.$col2$.y*this.$m_localOBB$.$extents$.y;
this.$syncAABB$.$minVertex$.x=g-e;this.$syncAABB$.$minVertex$.y=a-f;this.$syncAABB$.$maxVertex$.x=g+e;this.$syncAABB$.$maxVertex$.y=a+f;e=d.$col1$;f=d.$col2$;g=this.$m_localOBB$.$R$.$col1$;h=this.$m_localOBB$.$R$.$col2$;this.$syncMat$.$col1$.x=e.x*g.x+f.x*g.y;this.$syncMat$.$col1$.y=e.y*g.x+f.y*g.y;this.$syncMat$.$col2$.x=e.x*h.x+f.x*h.y;this.$syncMat$.$col2$.y=e.y*h.x+f.y*h.y;this.$syncMat$.$Abs$();e=this.$m_localCentroid$.x+this.$m_localOBB$.$center$.x;f=this.$m_localCentroid$.y+this.$m_localOBB$.$center$.y;
g=b.x+(d.$col1$.x*e+d.$col2$.x*f);a=b.y+(d.$col1$.y*e+d.$col2$.y*f);e=this.$syncMat$.$col1$.x*this.$m_localOBB$.$extents$.x+this.$syncMat$.$col2$.x*this.$m_localOBB$.$extents$.y;f=this.$syncMat$.$col1$.y*this.$m_localOBB$.$extents$.x+this.$syncMat$.$col2$.y*this.$m_localOBB$.$extents$.y;this.$syncAABB$.$minVertex$.x=Math.min(this.$syncAABB$.$minVertex$.x,g-e);this.$syncAABB$.$minVertex$.y=Math.min(this.$syncAABB$.$minVertex$.y,a-f);this.$syncAABB$.$maxVertex$.x=Math.max(this.$syncAABB$.$maxVertex$.x,
g+e);this.$syncAABB$.$maxVertex$.y=Math.max(this.$syncAABB$.$maxVertex$.y,a+f);b=this.$m_body$.$m_world$.$m_broadPhase$;Pb(b,this.$syncAABB$)?Sb(b,this.$m_proxyId$,this.$syncAABB$):Rb(this.$m_body$)}};
Ub.prototype.$ResetProxy$=function(a){if(this.$m_proxyId$!=M){a.$DestroyProxy$(this.$m_proxyId$);var c=new L(0,Nb(this.$m_R$,this.$m_localOBB$.$R$.$col1$),Nb(this.$m_R$,this.$m_localOBB$.$R$.$col2$));c=new L(0,new J(Math.abs(c.$col1$.x),Math.abs(c.$col1$.y)),new J(Math.abs(c.$col2$.x),Math.abs(c.$col2$.y)));c=Nb(c,this.$m_localOBB$.$extents$);var b=Nb(this.$m_R$,this.$m_localOBB$.$center$);b.add(this.$m_position$);var d=new Bb;K(d.$minVertex$,b);d.$minVertex$.$subtract$(c);K(d.$maxVertex$,b);d.$maxVertex$.add(c);
this.$m_proxyId$=Pb(a,d)?Qb(a,d,this):M;this.$m_proxyId$==M&&Rb(this.$m_body$)}};var Vb=new J,Wb=new L;function Xb(a,c){this.$sMat0$=new L;this.$m_position$=new J;K(this.$m_position$,a.position);this.$m_position0$=new J;K(this.$m_position0$,this.$m_position$);var b=0,d,e;this.$m_flags$=0;this.$m_rotation$=a.rotation;this.$m_R$=new L(0);this.$m_R$.$Set$(this.$m_rotation$);this.$m_rotation0$=this.$m_rotation$;this.$m_world$=c;this.$m_linearDamping$=Math.max(0,Math.min(1-a.$linearDamping$,1));this.$m_angularDamping$=Math.max(0,Math.min(1-a.$angularDamping$,1));this.$m_force$=new J(0,0);this.$m_mass$=
this.$m_torque$=0;var f=Array(64);for(b=0;b<64;b++)f[b]=new Mb;this.$m_shapeCount$=0;this.$m_center$=new J(0,0);for(b=0;b<64;++b){d=a.$shapes$[b];if(d==r)break;e=f[b];d.c(e);this.$m_mass$+=e.$mass$;this.$m_center$.x+=e.$mass$*(d.$localPosition$.x+e.$center$.x);this.$m_center$.y+=e.$mass$*(d.$localPosition$.y+e.$center$.y);++this.$m_shapeCount$}if(this.$m_mass$>0){this.$m_center$.scale(1/this.$m_mass$);this.$m_position$.add(Nb(this.$m_R$,this.$m_center$))}else this.$m_flags$|=Zb;for(b=this.$m_I$=0;b<
this.$m_shapeCount$;++b){d=a.$shapes$[b];e=f[b];this.$m_I$+=e.$I$;d=Ab(zb(d.$localPosition$,e.$center$),this.$m_center$);this.$m_I$+=e.$mass$*wb(d,d)}this.$m_invMass$=this.$m_mass$>0?1/this.$m_mass$:0;if(this.$m_I$>0&&a.$preventRotation$==s)this.$m_invI$=1/this.$m_I$;else this.$m_invI$=this.$m_I$=0;this.$m_linearVelocity$=zb(a.$linearVelocity$,new J(-a.$angularVelocity$*this.$m_center$.y,a.$angularVelocity$*this.$m_center$.x));this.$m_angularVelocity$=a.$angularVelocity$;this.$m_shapeList$=this.$m_next$=
this.$m_prev$=this.$m_contactList$=this.$m_jointList$=r;for(b=0;b<this.$m_shapeCount$;++b){d=a.$shapes$[b];var g;e=d;f=this.$m_center$;if(e instanceof Jb)g=new Ob(e,this,f);else if(e instanceof Kb)g=new Ub(e,this,f);else l("unsupported ShapeDef");g.$m_next$=this.$m_shapeList$;this.$m_shapeList$=g}this.$m_sleepTime$=0;a.$allowSleep$&&(this.$m_flags$|=ac);a.$isSleeping$&&(this.$m_flags$|=N);if(this.$m_flags$&N||this.$m_invMass$==0){this.$m_linearVelocity$.$Set$(0,0);this.$m_angularVelocity$=0}this.$m_userData$=
a.$userData$}function $b(a){a.$m_flags$&=~N;a.$m_sleepTime$=0}Xb.prototype.$GetNext$=ba("$m_next$");function Rb(a){a.$m_flags$|=gc;a.$m_linearVelocity$.$SetZero$();a.$m_angularVelocity$=0;for(a=a.$m_shapeList$;a!=r;a=a.$m_next$)a.$DestroyProxy$()}var Zb=1,gc=2,N=8,ac=16;function bc(){this.$stabbingCount$=this.$proxyId$=this.value=0}function cc(a,c){var b=a.value,d=a.$proxyId$,e=a.$stabbingCount$;a.value=c.value;a.$proxyId$=c.$proxyId$;a.$stabbingCount$=c.$stabbingCount$;c.value=b;c.$proxyId$=d;c.$stabbingCount$=e};function dc(){this.$lowerValues$=[0,0];this.$upperValues$=[0,0]};function ec(){this.$proxyId2$=this.$proxyId1$=0};function fc(){}fc.prototype={$SetBuffered$:function(){this.status|=hc},$ClearBuffered$:function(){this.status&=~hc},$IsBuffered$:function(){return(this.status&hc)==hc},$SetRemoved$:function(){this.status|=ic},$ClearRemoved$:function(){this.status&=~ic},$IsRemoved$:function(){return(this.status&ic)==ic},$SetFinal$:function(){this.status|=Ig},$IsFinal$:function(){return(this.status&Ig)==Ig},$proxyId1$:0,$proxyId2$:0,next:0,status:0};fc.prototype.$contactData$=r;var M=65535,hc=1,ic=2,Ig=4;function jc(){var a=0;this.$m_hashTable$=Array(8192);for(a=0;a<8192;++a)this.$m_hashTable$[a]=65535;this.$m_pairs$=Array(8192);for(a=0;a<8192;++a)this.$m_pairs$[a]=new fc;this.$m_pairBuffer$=Array(8192);for(a=0;a<8192;++a)this.$m_pairBuffer$[a]=new ec;for(a=0;a<8192;++a){this.$m_pairs$[a].$proxyId1$=M;this.$m_pairs$[a].$proxyId2$=M;this.$m_pairs$[a].$userData$=r;this.$m_pairs$[a].status=0;this.$m_pairs$[a].next=a+1}this.$m_pairs$[8191].next=65535;this.$m_pairCount$=0}
jc.prototype={$Initialize$:function(a,c){this.$m_broadPhase$=a;this.$m_callback$=c},$AddBufferedPair$:function(a,c){var b=this.$AddPair$(a,c);if(b.$IsBuffered$()==s){b.$SetBuffered$();this.$m_pairBuffer$[this.$m_pairBufferCount$].$proxyId1$=b.$proxyId1$;this.$m_pairBuffer$[this.$m_pairBufferCount$].$proxyId2$=b.$proxyId2$;++this.$m_pairBufferCount$}b.$ClearRemoved$()},$RemoveBufferedPair$:function(a,c){var b=kc(this,a,c);if(b!=r){if(b.$IsBuffered$()==s){b.$SetBuffered$();this.$m_pairBuffer$[this.$m_pairBufferCount$].$proxyId1$=
b.$proxyId1$;this.$m_pairBuffer$[this.$m_pairBufferCount$].$proxyId2$=b.$proxyId2$;++this.$m_pairBufferCount$}b.$SetRemoved$()}},$AddPair$:function(a,c){if(a>c){var b=a;a=c;c=b}b=lc(a,c)&8191;var d=mc(this,a,c,b);if(d!=r)return d;var e=this.$m_freePair$;d=this.$m_pairs$[e];this.$m_freePair$=d.next;d.$proxyId1$=a;d.$proxyId2$=c;d.status=0;d.$userData$=r;d.next=this.$m_hashTable$[b];this.$m_hashTable$[b]=e;++this.$m_pairCount$;return d},$RemovePair$:function(a,c){if(a>c){var b=a;a=c;c=b}for(var d=lc(a,
c)&8191,e=this.$m_hashTable$[d],f=r;e!=65535;)if(this.$m_pairs$[e].$proxyId1$==a&&this.$m_pairs$[e].$proxyId2$==c){b=e;if(f)f.next=this.$m_pairs$[e].next;else this.$m_hashTable$[d]=this.$m_pairs$[e].next;d=this.$m_pairs$[b];e=d.$userData$;d.next=this.$m_freePair$;d.$proxyId1$=M;d.$proxyId2$=M;d.$userData$=r;d.status=0;this.$m_freePair$=b;--this.$m_pairCount$;return e}else{f=this.$m_pairs$[e];e=f.next}return r},$m_broadPhase$:r,$m_callback$:r,$m_freePair$:0,$m_pairCount$:0,$m_pairBuffer$:r,$m_pairBufferCount$:0,
$m_hashTable$:r};function kc(a,c,b){if(c>b){var d=c;c=b;b=d}return mc(a,c,b,lc(c,b)&8191)}function mc(a,c,b,d){for(d=a.$m_hashTable$[d];d!=65535&&(a.$m_pairs$[d].$proxyId1$==c&&a.$m_pairs$[d].$proxyId2$==b)==s;)d=a.$m_pairs$[d].next;if(d==65535)return r;return a.$m_pairs$[d]}
jc.prototype.$Commit$=function(){var a=0,c=0,b=this.$m_broadPhase$.$proxyPool$,d=[];for(a=0;a<this.$m_pairBufferCount$;++a){var e=kc(this,this.$m_pairBuffer$[a].$proxyId1$,this.$m_pairBuffer$[a].$proxyId2$);e.$ClearBuffered$();var f=b[e.$proxyId1$],g=b[e.$proxyId2$];if(e.$IsRemoved$()){e.$IsFinal$()==o&&this.$m_callback$.$PairRemoved$(f.$userData$,g.$userData$,e.$userData$);this.$m_pairBuffer$[c].$proxyId1$=e.$proxyId1$;this.$m_pairBuffer$[c].$proxyId2$=e.$proxyId2$;++c}else if(e.$IsFinal$()==s){e.$contactData$=
this.$m_callback$.$PairAdded$(f.$userData$,g.$userData$);d.push(e.$contactData$);e.$SetFinal$()}}for(a=0;a<c;++a)this.$RemovePair$(this.$m_pairBuffer$[a].$proxyId1$,this.$m_pairBuffer$[a].$proxyId2$);this.$m_pairBufferCount$=0;return d};function lc(a,c){var b=c<<16&4294901760|a;b=~b+(b<<15&4294934528);b^=b>>12&1048575;b+=b<<2&4294967292;b^=b>>4&268435455;b*=2057;b^=b>>16&65535;return b};function nc(){this.$lowerBounds$=[0,0];this.$upperBounds$=[0,0];this.timeStamp=this.$overlapCount$=0;this.$userData$=r}nc.prototype={$GetNext$:function(){return this.$lowerBounds$[0]},$SetNext$:function(a){this.$lowerBounds$[0]=a},$IsValid$:function(){return this.$overlapCount$!=65535}};function oc(a,c){this.$m_pairManager$=new jc;this.$proxyPool$=Array(8192);this.$m_bounds$=Array(2048);this.$m_queryResults$=Array(1024);this.$m_quantizationFactor$=new J;var b=0;this.$m_pairManager$.$Initialize$(this,c);this.$m_worldAABB$=a;for(b=this.$m_proxyCount$=0;b<1024;b++)this.$m_queryResults$[b]=0;this.$m_bounds$=Array(2);for(b=0;b<2;b++){this.$m_bounds$[b]=Array(2048);for(var d=0;d<2048;d++)this.$m_bounds$[b][d]=new bc}b=a.$maxVertex$.x;d=a.$maxVertex$.y;b-=a.$minVertex$.x;d-=a.$minVertex$.y;
this.$m_quantizationFactor$.x=65535/b;this.$m_quantizationFactor$.y=65535/d;for(b=0;b<1023;++b){d=new nc;this.$proxyPool$[b]=d;d.$SetNext$(b+1);d.timeStamp=0;d.$overlapCount$=65535;d.$userData$=r}d=new nc;this.$proxyPool$[1023]=d;d.$SetNext$(M);d.timeStamp=0;d.$overlapCount$=65535;d.$userData$=r;this.$m_freeProxy$=0;this.$m_timeStamp$=1;this.$m_queryResultCount$=0}
function Pb(a,c){var b,d,e,f;b=c.$minVertex$.x;d=c.$minVertex$.y;b-=a.$m_worldAABB$.$maxVertex$.x;d-=a.$m_worldAABB$.$maxVertex$.y;e=a.$m_worldAABB$.$minVertex$.x;f=a.$m_worldAABB$.$minVertex$.y;e-=c.$maxVertex$.x;f-=c.$maxVertex$.y;b=Math.max(b,e);d=Math.max(d,f);return Math.max(b,d)<0}
oc.prototype.$DestroyProxy$=function(a){for(var c=this.$proxyPool$[a],b=2*this.$m_proxyCount$,d=0;d<2;++d){var e=this.$m_bounds$[d],f=c.$lowerBounds$[d],g=c.$upperBounds$[d],h=e[f].value,j=e[g].value,i=[],k=0,n=g-f-1,m,q;for(k=0;k<n;k++){i[k]=new bc;m=i[k];q=e[f+1+k];m.value=q.value;m.$proxyId$=q.$proxyId$;m.$stabbingCount$=q.$stabbingCount$}n=i.length;var x=f;for(k=0;k<n;k++){q=i[k];m=e[x+k];m.value=q.value;m.$proxyId$=q.$proxyId$;m.$stabbingCount$=q.$stabbingCount$}i=[];n=b-g-1;for(k=0;k<n;k++){i[k]=
new bc;m=i[k];q=e[g+1+k];m.value=q.value;m.$proxyId$=q.$proxyId$;m.$stabbingCount$=q.$stabbingCount$}n=i.length;x=g-1;for(k=0;k<n;k++){q=i[k];m=e[x+k];m.value=q.value;m.$proxyId$=q.$proxyId$;m.$stabbingCount$=q.$stabbingCount$}n=b-2;for(i=f;i<n;++i){k=this.$proxyPool$[e[i].$proxyId$];if((e[i].value&1)==0)k.$lowerBounds$[d]=i;else k.$upperBounds$[d]=i}for(n=g-1;f<n;++f)e[f].$stabbingCount$--;this.$Query$([0],[0],h,j,e,b-2,d)}for(b=0;b<this.$m_queryResultCount$;++b)this.$m_pairManager$.$RemoveBufferedPair$(a,
this.$m_queryResults$[b]);this.$m_pairManager$.$Commit$();this.$m_queryResultCount$=0;pc(this);c.$userData$=r;c.$overlapCount$=65535;c.$lowerBounds$[0]=65535;c.$lowerBounds$[1]=65535;c.$upperBounds$[0]=65535;c.$upperBounds$[1]=65535;c.$SetNext$(this.$m_freeProxy$);this.$m_freeProxy$=a;--this.$m_proxyCount$};
function qc(a,c,b,d){var e=d.$minVertex$.x,f=d.$minVertex$.y;e=Math.min(e,a.$m_worldAABB$.$maxVertex$.x);f=Math.min(f,a.$m_worldAABB$.$maxVertex$.y);e=Math.max(e,a.$m_worldAABB$.$minVertex$.x);f=Math.max(f,a.$m_worldAABB$.$minVertex$.y);var g=d.$maxVertex$.x;d=d.$maxVertex$.y;g=Math.min(g,a.$m_worldAABB$.$maxVertex$.x);d=Math.min(d,a.$m_worldAABB$.$maxVertex$.y);g=Math.max(g,a.$m_worldAABB$.$minVertex$.x);d=Math.max(d,a.$m_worldAABB$.$minVertex$.y);c[0]=a.$m_quantizationFactor$.x*(e-a.$m_worldAABB$.$minVertex$.x)&
65534;b[0]=a.$m_quantizationFactor$.x*(g-a.$m_worldAABB$.$minVertex$.x)&65535|1;c[1]=a.$m_quantizationFactor$.y*(f-a.$m_worldAABB$.$minVertex$.y)&65534;b[1]=a.$m_quantizationFactor$.y*(d-a.$m_worldAABB$.$minVertex$.y)&65535|1}function rc(a,c,b){for(var d=0;d<2;++d){var e=a.$m_bounds$[d];if(c.$lowerValues$[d]>e[b.$upperBounds$[d]].value)return s;if(c.$upperValues$[d]<e[b.$lowerBounds$[d]].value)return s}return o}
oc.prototype.$Query$=function(a,c,b,d,e,f,g){b=sc(e,f,b);d=sc(e,f,d);for(f=b;f<d;++f)(e[f].value&1)==0&&tc(this,e[f].$proxyId$);if(b>0){f=b-1;for(var h=e[f].$stabbingCount$;h;){if((e[f].value&1)==0&&b<=this.$proxyPool$[e[f].$proxyId$].$upperBounds$[g]){tc(this,e[f].$proxyId$);--h}--f}}a[0]=b;c[0]=d};
function tc(a,c){var b=a.$proxyPool$[c];if(b.timeStamp<a.$m_timeStamp$){b.timeStamp=a.$m_timeStamp$;b.$overlapCount$=1}else{b.$overlapCount$=2;a.$m_queryResults$[a.$m_queryResultCount$]=c;++a.$m_queryResultCount$}}function pc(a){if(a.$m_timeStamp$==65535){for(var c=0;c<1024;++c)a.$proxyPool$[c].timeStamp=0;a.$m_timeStamp$=1}else++a.$m_timeStamp$}
function Sb(a,c,b){var d=0,e=0,f,g;f=0;var h;if(!(c==M||1024<=c)&&b.$IsValid$()!=s){var j=2*a.$m_proxyCount$,i=a.$proxyPool$[c],k=new dc;qc(a,k.$lowerValues$,k.$upperValues$,b);var n=new dc;for(d=0;d<2;++d){n.$lowerValues$[d]=a.$m_bounds$[d][i.$lowerBounds$[d]].value;n.$upperValues$[d]=a.$m_bounds$[d][i.$upperBounds$[d]].value}for(d=0;d<2;++d){var m=a.$m_bounds$[d],q=i.$lowerBounds$[d],x=i.$upperBounds$[d],z=k.$lowerValues$[d],w=k.$upperValues$[d],u=z-m[q].value,y=w-m[x].value;m[q].value=z;m[x].value=
w;if(u<0)for(e=q;e>0&&z<m[e-1].value;){b=m[e];f=m[e-1];g=f.$proxyId$;h=a.$proxyPool$[f.$proxyId$];f.$stabbingCount$++;if((f.value&1)==1==o){rc(a,k,h)&&a.$m_pairManager$.$AddBufferedPair$(c,g);h.$upperBounds$[d]++;b.$stabbingCount$++}else{h.$lowerBounds$[d]++;b.$stabbingCount$--}i.$lowerBounds$[d]--;cc(b,f);--e}if(y>0)for(e=x;e<j-1&&m[e+1].value<=w;){b=m[e];g=m[e+1];f=g.$proxyId$;h=a.$proxyPool$[f];g.$stabbingCount$++;if((g.value&1)==0==o){rc(a,k,h)&&a.$m_pairManager$.$AddBufferedPair$(c,f);h.$lowerBounds$[d]--;
b.$stabbingCount$++}else{h.$upperBounds$[d]--;b.$stabbingCount$--}i.$upperBounds$[d]++;cc(b,g);e++}if(u>0)for(e=q;e<j-1&&m[e+1].value<=z;){b=m[e];g=m[e+1];f=g.$proxyId$;h=a.$proxyPool$[f];g.$stabbingCount$--;if((g.value&1)==1){rc(a,n,h)&&a.$m_pairManager$.$RemoveBufferedPair$(c,f);h.$upperBounds$[d]--;b.$stabbingCount$--}else{h.$lowerBounds$[d]--;b.$stabbingCount$++}i.$lowerBounds$[d]++;cc(b,g);e++}if(y<0)for(e=x;e>0&&w<m[e-1].value;){b=m[e];f=m[e-1];g=f.$proxyId$;h=a.$proxyPool$[g];f.$stabbingCount$--;
if((f.value&1)==0==o){rc(a,n,h)&&a.$m_pairManager$.$RemoveBufferedPair$(c,g);h.$lowerBounds$[d]++;b.$stabbingCount$--}else{h.$upperBounds$[d]++;b.$stabbingCount$++}i.$upperBounds$[d]--;cc(b,f);e--}}}}oc.prototype.$Commit$=function(){return this.$m_pairManager$.$Commit$()};
function Qb(a,c,b){var d=0,e,f=a.$m_freeProxy$;e=a.$proxyPool$[f];a.$m_freeProxy$=e.$GetNext$();e.$overlapCount$=0;e.$userData$=b;b=2*a.$m_proxyCount$;e=[];var g=[];qc(a,e,g,c);for(c=0;c<2;++c){var h=a.$m_bounds$[c],j=0,i=0;j=[j];i=[i];a.$Query$(j,i,e[c],g[c],h,b,c);j=j[0];i=i[0];d=[];var k=0,n=b-i,m,q;for(k=0;k<n;k++){d[k]=new bc;m=d[k];q=h[i+k];m.value=q.value;m.$proxyId$=q.$proxyId$;m.$stabbingCount$=q.$stabbingCount$}n=d.length;var x=i+2;for(k=0;k<n;k++){q=d[k];m=h[x+k];m.value=q.value;m.$proxyId$=
q.$proxyId$;m.$stabbingCount$=q.$stabbingCount$}d=[];n=i-j;for(k=0;k<n;k++){d[k]=new bc;m=d[k];q=h[j+k];m.value=q.value;m.$proxyId$=q.$proxyId$;m.$stabbingCount$=q.$stabbingCount$}n=d.length;x=j+1;for(k=0;k<n;k++){q=d[k];m=h[x+k];m.value=q.value;m.$proxyId$=q.$proxyId$;m.$stabbingCount$=q.$stabbingCount$}++i;h[j].value=e[c];h[j].$proxyId$=f;h[i].value=g[c];h[i].$proxyId$=f;h[j].$stabbingCount$=j==0?0:h[j-1].$stabbingCount$;h[i].$stabbingCount$=h[i-1].$stabbingCount$;for(d=j;d<i;++d)h[d].$stabbingCount$++;
for(d=j;d<b+2;++d){j=a.$proxyPool$[h[d].$proxyId$];if((h[d].value&1)==0)j.$lowerBounds$[c]=d;else j.$upperBounds$[c]=d}}++a.$m_proxyCount$;for(b=0;b<a.$m_queryResultCount$;++b)a.$m_pairManager$.$AddBufferedPair$(f,a.$m_queryResults$[b]);a.$m_pairManager$.$Commit$();a.$m_queryResultCount$=0;pc(a);return f}function sc(a,c,b){var d=0;for(c-=1;d<=c;){var e=Math.floor((d+c)/2);if(a[e].value>b)c=e-1;else if(a[e].value<b)d=e+1;else return e}return d};var uc=new (aa());function O(){this.next=this.prev=this.$contact$=this.$other$=r};function vc(){this.$primary$=this.$destroyFcn$=this.$createFcn$=r};function wc(a,c){this.$m_node1$=new O;this.$m_node2$=new O;this.$m_flags$=0;if(!a||!c)this.$m_shape2$=this.$m_shape1$=r;else{this.$m_shape1$=a;this.$m_shape2$=c;this.$m_manifoldCount$=0;this.$m_friction$=Math.sqrt(this.$m_shape1$.$m_friction$*this.$m_shape2$.$m_friction$);this.$m_restitution$=Math.max(this.$m_shape1$.$m_restitution$,this.$m_shape2$.$m_restitution$);this.$m_next$=this.$m_prev$=r;this.$m_node1$.$contact$=r;this.$m_node1$.prev=r;this.$m_node1$.next=r;this.$m_node1$.$other$=r;this.$m_node2$.$contact$=
r;this.$m_node2$.prev=r;this.$m_node2$.next=r;this.$m_node2$.$other$=r}}wc.prototype.$GetManifolds$=ca(r);wc.prototype.$GetNext$=ba("$m_next$");wc.prototype.$Evaluate$=aa();function xc(a){this.$_m_id$=a;this.$_flip$=this.$_referenceFace$=this.$_incidentVertex$=this.$_incidentEdg$=0};function yc(){this.$_key$=0;this.$features$=new xc(this)}yc.prototype.$Set$=function(a){zc(this,a.$_key$)};yc.prototype.$Copy$=function(){var a=new yc;zc(a,this.$_key$);return a};function zc(a,c){a.$_key$=c;a.$features$.$_referenceFace$=a.$_key$&255;a.$features$.$_incidentEdge$=(a.$_key$&65280)>>8&255;a.$features$.$_incidentVertex$=(a.$_key$&16711680)>>16&255;a.$features$.$_flip$=(a.$_key$&4278190080)>>24&255};function Ac(){this.$v$=new J;this.id=new yc};function Bc(a,c,b,d){var e=0,f=c[0].$v$,g=c[1].$v$,h=wb(b,c[0].$v$)-d;b=wb(b,c[1].$v$)-d;h<=0&&(a[e++]=c[0]);b<=0&&(a[e++]=c[1]);if(h*b<0){b=h/(h-b);d=a[e].$v$;d.x=f.x+b*(g.x-f.x);d.y=f.y+b*(g.y-f.y);a[e].id=h>0?c[0].id:c[1].id;++e}return e}
function Cc(a,c,b){var d=a.$m_vertices$,e=b.$m_vertexCount$,f=b.$m_vertices$,g=a.$m_normals$[c].x,h=a.$m_normals$[c].y,j=g,i=a.$m_R$;g=i.$col1$.x*j+i.$col2$.x*h;h=i.$col1$.y*j+i.$col2$.y*h;var k=g,n=h;i=b.$m_R$;j=k*i.$col1$.x+n*i.$col1$.y;n=k*i.$col2$.x+n*i.$col2$.y;k=j;j=0;i=Number.MAX_VALUE;for(var m=0;m<e;++m){var q=f[m];q=q.x*k+q.y*n;if(q<i){i=q;j=m}}i=a.$m_R$;e=a.$m_position$.x+(i.$col1$.x*d[c].x+i.$col2$.x*d[c].y);a=a.$m_position$.y+(i.$col1$.y*d[c].x+i.$col2$.y*d[c].y);i=b.$m_R$;c=b.$m_position$.x+
(i.$col1$.x*f[j].x+i.$col2$.x*f[j].y);b=b.$m_position$.y+(i.$col1$.y*f[j].x+i.$col2$.y*f[j].y);c-=e;b-=a;return c*g+b*h}
function Dc(a,c,b,d){var e=c.$m_vertexCount$,f=b.$m_position$.x-c.$m_position$.x,g=b.$m_position$.y-c.$m_position$.y,h=f*c.$m_R$.$col1$.x+g*c.$m_R$.$col1$.y;g=f*c.$m_R$.$col2$.x+g*c.$m_R$.$col2$.y;f=0;for(var j=-Number.MAX_VALUE,i=0;i<e;++i){var k=c.$m_normals$[i].x*h+c.$m_normals$[i].y*g;if(k>j){j=k;f=i}}h=Cc(c,f,b);if(h>0&&d==s)return h;i=f-1>=0?f-1:e-1;k=Cc(c,i,b);if(k>0&&d==s)return k;var n=f+1<e?f+1:0,m=Cc(c,n,b);if(m>0&&d==s)return m;j=g=0;if(k>h&&k>m){j=-1;g=i;i=k}else if(m>h){j=1;g=n;i=m}else{a[0]=
f;return h}for(;;){f=j==-1?g-1>=0?g-1:e-1:g+1<e?g+1:0;h=Cc(c,f,b);if(h>0&&d==s)return h;if(h>i){g=f;i=h}else break}a[0]=g;return i}var Ec=new J;function Fc(){this.position=new J;this.id=new yc;this.$tangentImpulse$=this.$normalImpulse$=this.$separation$=r};function Gc(){this.$pointCount$=0;this.$points$=Array(2);for(var a=0;a<2;a++)this.$points$[a]=new Fc;this.$normal$=new J};function Hc(a,c){this.$m_node1$=new O;this.$m_node2$=new O;this.$m_flags$=0;if(!a||!c)this.$m_shape2$=this.$m_shape1$=r;else{this.$m_shape1$=a;this.$m_shape2$=c;this.$m_manifoldCount$=0;this.$m_friction$=Math.sqrt(this.$m_shape1$.$m_friction$*this.$m_shape2$.$m_friction$);this.$m_restitution$=Math.max(this.$m_shape1$.$m_restitution$,this.$m_shape2$.$m_restitution$);this.$m_next$=this.$m_prev$=r;this.$m_node1$.$contact$=r;this.$m_node1$.prev=r;this.$m_node1$.next=r;this.$m_node1$.$other$=r;this.$m_node2$.$contact$=
r;this.$m_node2$.prev=r;this.$m_node2$.next=r;this.$m_node2$.$other$=r;this.$m_manifold$=[new Gc];this.$m_manifold$[0].$pointCount$=0;this.$m_manifold$[0].$points$[0].$normalImpulse$=0;this.$m_manifold$[0].$points$[0].$tangentImpulse$=0}}E(Hc,wc);
Hc.prototype.$Evaluate$=function(){var a=this.$m_manifold$[0],c=this.$m_shape1$,b=this.$m_shape2$;a.$pointCount$=0;var d=b.$m_position$.x-c.$m_position$.x,e=b.$m_position$.y-c.$m_position$.y,f=d*d+e*e;c=c.$m_radius$+b.$m_radius$;if(!(f>c*c)){if(f<Number.MIN_VALUE){f=-c;a.$normal$.$Set$(0,1)}else{var g=Math.sqrt(f);f=g-c;c=1/g;a.$normal$.x=c*d;a.$normal$.y=c*e}a.$pointCount$=1;d=a.$points$[0];zc(d.id,0);d.$separation$=f;d.position.x=b.$m_position$.x-b.$m_radius$*a.$normal$.x;d.position.y=b.$m_position$.y-
b.$m_radius$*a.$normal$.y}this.$m_manifoldCount$=this.$m_manifold$[0].$pointCount$>0?1:0};Hc.prototype.$GetManifolds$=ba("$m_manifold$");function Ic(a,c){return new Hc(a,c)};function Jc(a,c){this.$m_node1$=new O;this.$m_node2$=new O;this.$m_flags$=0;if(!a||!c)this.$m_shape2$=this.$m_shape1$=r;else{this.$m_shape1$=a;this.$m_shape2$=c;this.$m_manifoldCount$=0;this.$m_friction$=Math.sqrt(this.$m_shape1$.$m_friction$*this.$m_shape2$.$m_friction$);this.$m_restitution$=Math.max(this.$m_shape1$.$m_restitution$,this.$m_shape2$.$m_restitution$);this.$m_next$=this.$m_prev$=r;this.$m_node1$.$contact$=r;this.$m_node1$.prev=r;this.$m_node1$.next=r;this.$m_node1$.$other$=r;this.$m_node2$.$contact$=
r;this.$m_node2$.prev=r;this.$m_node2$.next=r;this.$m_node2$.$other$=r;this.$m_manifold$=[new Gc];this.$m_manifold$[0].$pointCount$=0;this.$m_manifold$[0].$points$[0].$normalImpulse$=0;this.$m_manifold$[0].$points$[0].$tangentImpulse$=0}}E(Jc,wc);
Jc.prototype.$Evaluate$=function(){a:{var a=this.$m_manifold$[0],c=this.$m_shape1$,b=this.$m_shape2$;a.$pointCount$=0;var d,e,f;e=b.$m_position$.x-c.$m_position$.x;f=b.$m_position$.y-c.$m_position$.y;var g=c.$m_R$,h=e*g.$col1$.x+f*g.$col1$.y;f=e*g.$col2$.x+f*g.$col2$.y;e=h;var j=0,i=-Number.MAX_VALUE;h=b.$m_radius$;for(d=0;d<c.$m_vertexCount$;++d){var k=c.$m_normals$[d].x*(e-c.$m_vertices$[d].x)+c.$m_normals$[d].y*(f-c.$m_vertices$[d].y);if(k>h)break a;if(k>i){i=k;j=d}}if(i<Number.MIN_VALUE){a.$pointCount$=
1;f=c.$m_normals$[j];a.$normal$.x=g.$col1$.x*f.x+g.$col2$.x*f.y;a.$normal$.y=g.$col1$.y*f.x+g.$col2$.y*f.y;d=a.$points$[0];d.id.$features$.$incidentEdge$=j;d.id.$features$.$incidentVertex$=255;d.id.$features$.$referenceFace$=255;d.id.$features$.$flip$=0;d.position.x=b.$m_position$.x-h*a.$normal$.x;d.position.y=b.$m_position$.y-h*a.$normal$.y;d.$separation$=i-h}else{i=j+1<c.$m_vertexCount$?j+1:0;var n=c.$m_vertices$[i].x-c.$m_vertices$[j].x;k=c.$m_vertices$[i].y-c.$m_vertices$[j].y;var m=Math.sqrt(n*
n+k*k);n/=m;k/=m;if(m<Number.MIN_VALUE){e-=c.$m_vertices$[j].x;f-=c.$m_vertices$[j].y;c=Math.sqrt(e*e+f*f);e/=c;f/=c;if(!(c>h)){a.$pointCount$=1;a.$normal$.$Set$(g.$col1$.x*e+g.$col2$.x*f,g.$col1$.y*e+g.$col2$.y*f);d=a.$points$[0];d.id.$features$.$incidentEdge$=255;d.id.$features$.$incidentVertex$=j;d.id.$features$.$referenceFace$=255;d.id.$features$.$flip$=0;d.position.x=b.$m_position$.x-h*a.$normal$.x;d.position.y=b.$m_position$.y-h*a.$normal$.y;d.$separation$=c-h}}else{var q=(e-c.$m_vertices$[j].x)*
n+(f-c.$m_vertices$[j].y)*k;d=a.$points$[0];d.id.$features$.$incidentEdge$=255;d.id.$features$.$incidentVertex$=255;d.id.$features$.$referenceFace$=255;d.id.$features$.$flip$=0;if(q<=0){n=c.$m_vertices$[j].x;c=c.$m_vertices$[j].y;d.id.$features$.$incidentVertex$=j}else if(q>=m){n=c.$m_vertices$[i].x;c=c.$m_vertices$[i].y;d.id.$features$.$incidentVertex$=i}else{n=n*q+c.$m_vertices$[j].x;c=k*q+c.$m_vertices$[j].y;d.id.$features$.$incidentEdge$=j}e-=n;f-=c;c=Math.sqrt(e*e+f*f);e/=c;f/=c;if(!(c>h)){a.$pointCount$=
1;a.$normal$.$Set$(g.$col1$.x*e+g.$col2$.x*f,g.$col1$.y*e+g.$col2$.y*f);d.position.x=b.$m_position$.x-h*a.$normal$.x;d.position.y=b.$m_position$.y-h*a.$normal$.y;d.$separation$=c-h}}}}this.$m_manifoldCount$=this.$m_manifold$[0].$pointCount$>0?1:0};Jc.prototype.$GetManifolds$=ba("$m_manifold$");function Kc(a,c){return new Jc(a,c)};function Lc(a,c){this.$m_node1$=new O;this.$m_node2$=new O;this.$m_flags$=0;if(!a||!c)this.$m_shape2$=this.$m_shape1$=r;else{this.$m_shape1$=a;this.$m_shape2$=c;this.$m_manifoldCount$=0;this.$m_friction$=Math.sqrt(this.$m_shape1$.$m_friction$*this.$m_shape2$.$m_friction$);this.$m_restitution$=Math.max(this.$m_shape1$.$m_restitution$,this.$m_shape2$.$m_restitution$);this.$m_next$=this.$m_prev$=r;this.$m_node1$.$contact$=r;this.$m_node1$.prev=r;this.$m_node1$.next=r;this.$m_node1$.$other$=r;this.$m_node2$.$contact$=
r;this.$m_node2$.prev=r;this.$m_node2$.next=r;this.$m_node2$.$other$=r;this.$m0$=new Gc;this.$m_manifold$=[new Gc];this.$m_manifold$[0].$pointCount$=0}}E(Lc,wc);
Lc.prototype.$Evaluate$=function(){for(var a=this.$m_manifold$[0],c=this.$m0$.$points$,b=0;b<a.$pointCount$;b++){var d=c[b],e=a.$points$[b];d.$normalImpulse$=e.$normalImpulse$;d.$tangentImpulse$=e.$tangentImpulse$;d.id=e.id.$Copy$()}this.$m0$.$pointCount$=a.$pointCount$;b=this.$m_shape1$;var f=this.$m_shape2$;a.$pointCount$=0;var g;c=[0];d=Dc(c,b,f,s);g=c[0];if(!(d>0)){var h;c=[0];var j=Dc(c,f,b,s);h=c[0];if(!(j>0)){c=e=0;if(j>0.98*d+0.0010){d=f;j=b;e=h;c=1}else{d=b;j=f;e=g;c=0}b=[new Ac,new Ac];
f=e;g=j;var i=d.$m_vertices$;j=g.$m_vertexCount$;h=g.$m_vertices$;var k=i[f+1==d.$m_vertexCount$?0:f+1],n=k.x,m=k.y;k=i[f];n-=k.x;m-=k.y;k=n;n=m;m=-k;k=1/Math.sqrt(n*n+m*m);n*=k;m*=k;k=n;i=d.$m_R$;n=i.$col1$.x*k+i.$col2$.x*m;m=i.$col1$.y*k+i.$col2$.y*m;i=g.$m_R$;k=n*i.$col1$.x+m*i.$col1$.y;m=n*i.$col2$.x+m*i.$col2$.y;n=k;for(var q=i=0,x=Number.MAX_VALUE,z=0;z<j;++z){var w=z,u=z+1<j?z+1:0;k=h[u];var y=k.x,p=k.y;k=h[w];y-=k.x;p-=k.y;k=y;y=p;p=-k;k=1/Math.sqrt(y*y+p*p);y*=k;p*=k;k=y*n+p*m;if(k<x){x=
k;i=w;q=u}}j=b[0];k=j.$v$;K(k,h[i]);xb(k,g.$m_R$);k.add(g.$m_position$);j.id.$features$.$referenceFace$=f;j.id.$features$.$incidentEdge$=i;j.id.$features$.$incidentVertex$=i;j=b[1];k=j.$v$;K(k,h[q]);xb(k,g.$m_R$);k.add(g.$m_position$);j.id.$features$.$referenceFace$=f;j.id.$features$.$incidentEdge$=i;j.id.$features$.$incidentVertex$=q;f=d.$m_vertices$;k=f[e];n=e+1<d.$m_vertexCount$?f[e+1]:f[0];g=n.x-k.x;h=n.y-k.y;m=g;i=d.$m_R$;g=i.$col1$.x*m+i.$col2$.x*h;h=i.$col1$.y*m+i.$col2$.y*h;e=1/Math.sqrt(g*
g+h*h);g*=e;h*=e;m=g;e=h;f=-m;j=k.x;q=k.y;m=j;i=d.$m_R$;j=i.$col1$.x*m+i.$col2$.x*q;q=i.$col1$.y*m+i.$col2$.y*q;j+=d.$m_position$.x;q+=d.$m_position$.y;k=n.x;n=n.y;m=k;i=d.$m_R$;k=i.$col1$.x*m+i.$col2$.x*n;n=i.$col1$.y*m+i.$col2$.y*n;k+=d.$m_position$.x;n+=d.$m_position$.y;d=e*j+f*q;m=-(g*j+h*q);k=g*k+h*n;n=[new Ac,new Ac];j=[new Ac,new Ac];i=0;Ec.$Set$(-g,-h);i=Bc(n,b,Ec,m);if(!(i<2)){Ec.$Set$(g,h);i=Bc(j,n,Ec,k);if(!(i<2)){c?a.$normal$.$Set$(-e,-f):a.$normal$.$Set$(e,f);for(g=b=0;g<2;++g){h=j[g].$v$;
h=e*h.x+f*h.y-d;if(h<=0){k=a.$points$[b];k.$separation$=h;K(k.position,j[g].$v$);k.id.$Set$(j[g].id);k.id.$features$.$flip$=c;++b}}a.$pointCount$=b}}}}if(a.$pointCount$>0){c=[s,s];for(b=0;b<a.$pointCount$;++b){d=a.$points$[b];d.$normalImpulse$=0;d.$tangentImpulse$=0;e=d.id.key;for(f=0;f<this.$m0$.$pointCount$;++f)if(c[f]!=o){g=this.$m0$.$points$[f];if(g.id.key==e){c[f]=o;d.$normalImpulse$=g.$normalImpulse$;d.$tangentImpulse$=g.$tangentImpulse$;break}}}this.$m_manifoldCount$=1}else this.$m_manifoldCount$=
0};Lc.prototype.$GetManifolds$=ba("$m_manifold$");function Mc(a,c){return new Lc(a,c)};function Nc(a,c,b){P[c][b].$createFcn$=a;P[c][b].$primary$=o;if(c!=b){P[b][c].$createFcn$=a;P[b][c].$primary$=s}}var P=r,Oc=s;function Pc(a,c){this.$m_node1$=new O;this.$m_node2$=new O;this.$m_flags$=0;if(!a||!c)this.$m_shape2$=this.$m_shape1$=r;else{this.$m_shape1$=a;this.$m_shape2$=c;this.$m_manifoldCount$=0;this.$m_friction$=Math.sqrt(this.$m_shape1$.$m_friction$*this.$m_shape2$.$m_friction$);this.$m_restitution$=Math.max(this.$m_shape1$.$m_restitution$,this.$m_shape2$.$m_restitution$);this.$m_next$=this.$m_prev$=r;this.$m_node1$.$contact$=r;this.$m_node1$.prev=r;this.$m_node1$.next=r;this.$m_node1$.$other$=r;this.$m_node2$.$contact$=
r;this.$m_node2$.prev=r;this.$m_node2$.next=r;this.$m_node2$.$other$=r}}E(Pc,wc);Pc.prototype.$Evaluate$=aa();Pc.prototype.$GetManifolds$=ca(r);function Qc(){}Qc.prototype.$PairAdded$=ca(r);Qc.prototype.$PairRemoved$=aa();function Rc(a){this.$m_nullContact$=new Pc;this.$m_world$=a;this.$m_destroyImmediate$=s}E(Rc,Qc);
Rc.prototype.$PairAdded$=function(a,c){var b=a,d=c,e=b.$m_body$,f=d.$m_body$;if((e.$m_flags$&Zb)==Zb&&(f.$m_flags$&Zb)==Zb)return this.$m_nullContact$;if(b.$m_body$==d.$m_body$)return this.$m_nullContact$;a:{for(var g=f.$m_jointList$;g!=r;g=g.next)if(g.$other$==e){e=g.$joint$.$m_collideConnected$==s;break a}e=s}if(e)return this.$m_nullContact$;e=b.$m_groupIndex$==d.$m_groupIndex$&&b.$m_groupIndex$!=0?b.$m_groupIndex$>0:(b.$maskBits$&d.$categoryBits$)!=0&&(b.$categoryBits$&d.$maskBits$)!=0;if(e==s)return this.$m_nullContact$;
if(f.$m_invMass$==0){f=b;b=d;d=f}if(Oc==s){P=Array(4);for(f=0;f<4;f++){P[f]=Array(4);for(e=0;e<4;e++)P[f][e]=new vc}Nc(Ic,0,0);Nc(Kc,2,0);Nc(Mc,2,2);Oc=o}f=b.$m_type$;e=d.$m_type$;if(g=P[f][e].$createFcn$)if(P[f][e].$primary$)d=g(b,d);else{d=g(d,b);for(b=0;b<d.$m_manifoldCount$;++b){f=d.$GetManifolds$()[b];f.$normal$=new J(-f.$normal$.x,-f.$normal$.y)}}else d=r;if(d==r)return this.$m_nullContact$;else{d.$m_prev$=r;d.$m_next$=this.$m_world$.$m_contactList$;if(this.$m_world$.$m_contactList$!=r)this.$m_world$.$m_contactList$.$m_prev$=
d;this.$m_world$.$m_contactList$=d;this.$m_world$.$m_contactCount$++}return d};Rc.prototype.$PairRemoved$=function(a,c,b){if(b!=r&&b!=this.$m_nullContact$)if(this.$m_destroyImmediate$==o)Sc(this,b);else b.$m_flags$|=2};
function Sc(a,c){if(c.$m_prev$)c.$m_prev$.$m_next$=c.$m_next$;if(c.$m_next$)c.$m_next$.$m_prev$=c.$m_prev$;if(c==a.$m_world$.$m_contactList$)a.$m_world$.$m_contactList$=c.$m_next$;if(c.$m_manifoldCount$>0){var b=c.$m_shape1$.$m_body$,d=c.$m_shape2$.$m_body$,e=c.$m_node1$,f=c.$m_node2$;$b(b);$b(d);if(e.prev)e.prev.next=e.next;if(e.next)e.next.prev=e.prev;if(e==b.$m_contactList$)b.$m_contactList$=e.next;e.prev=r;e.next=r;if(f.prev)f.prev.next=f.next;if(f.next)f.next.prev=f.prev;if(f==d.$m_contactList$)d.$m_contactList$=
f.next;f.prev=r;f.next=r}--a.$m_world$.$m_contactCount$};function Tc(){this.$localAnchor1$=new J;this.$localAnchor2$=new J;this.$velocityBias$=this.$separation$=this.$tangentMass$=this.$normalMass$=this.$positionImpulse$=this.$tangentImpulse$=this.$normalImpulse$=r};function Uc(){this.$restitution$=this.$friction$=this.$body2$=this.$body1$=this.$manifold$=r;this.$pointCount$=0;this.$normal$=new J;this.$points$=Array(2);for(var a=0;a<2;a++)this.$points$[a]=new Tc};function Vc(a,c){this.$m_constraints$=[];var b=0,d,e;for(b=this.$m_constraintCount$=0;b<c;++b)this.$m_constraintCount$+=a[b].$m_manifoldCount$;for(b=0;b<this.$m_constraintCount$;b++)this.$m_constraints$[b]=new Uc;var f=0;for(b=0;b<c;++b){var g=a[b],h=g.$m_shape1$.$m_body$,j=g.$m_shape2$.$m_body$,i=g.$m_manifoldCount$,k=g.$GetManifolds$(),n=g.$m_friction$;g=g.$m_restitution$;for(var m=h.$m_linearVelocity$.x,q=h.$m_linearVelocity$.y,x=j.$m_linearVelocity$.x,z=j.$m_linearVelocity$.y,w=h.$m_angularVelocity$,
u=j.$m_angularVelocity$,y=0;y<i;++y){var p=k[y],v=p.$normal$.x,B=p.$normal$.y,A=this.$m_constraints$[f];A.$body1$=h;A.$body2$=j;A.$manifold$=p;A.$normal$.x=v;A.$normal$.y=B;A.$pointCount$=p.$pointCount$;A.$friction$=n;A.$restitution$=g;for(var H=0;H<A.$pointCount$;++H){var G=p.$points$[H],R=A.$points$[H];R.$normalImpulse$=G.$normalImpulse$;R.$tangentImpulse$=G.$tangentImpulse$;R.$separation$=G.$separation$;var Y=G.position.x-h.$m_position$.x,xa=G.position.y-h.$m_position$.y,ya=G.position.x-j.$m_position$.x;
G=G.position.y-j.$m_position$.y;d=R.$localAnchor1$;e=h.$m_R$;d.x=Y*e.$col1$.x+xa*e.$col1$.y;d.y=Y*e.$col2$.x+xa*e.$col2$.y;d=R.$localAnchor2$;e=j.$m_R$;d.x=ya*e.$col1$.x+G*e.$col1$.y;d.y=ya*e.$col2$.x+G*e.$col2$.y;d=Y*Y+xa*xa;e=ya*ya+G*G;var gb=Y*v+xa*B,ka=ya*v+G*B,la=h.$m_invMass$+j.$m_invMass$;la+=h.$m_invI$*(d-gb*gb)+j.$m_invI$*(e-ka*ka);R.$normalMass$=1/la;ka=B;la=-v;gb=Y*ka+xa*la;ka=ya*ka+G*la;la=h.$m_invMass$+j.$m_invMass$;la+=h.$m_invI$*(d-gb*gb)+j.$m_invI$*(e-ka*ka);R.$tangentMass$=1/la;R.$velocityBias$=
0;if(R.$separation$>0)R.$velocityBias$=-60*R.$separation$;Y=A.$normal$.x*(x+-u*G-m- -w*xa)+A.$normal$.y*(z+u*ya-q-w*Y);Y<-30&&(R.$velocityBias$+=-A.$restitution$*Y)}++f}}}
Vc.prototype={$PreSolve$:function(){for(var a,c,b=0;b<this.$m_constraintCount$;++b){var d=this.$m_constraints$[b],e=d.$body1$,f=d.$body2$,g=e.$m_invMass$,h=e.$m_invI$,j=f.$m_invMass$,i=f.$m_invI$,k=d.$normal$.x,n=d.$normal$.y,m=n,q=-k,x=0,z=0;if(Wc){z=d.$pointCount$;for(x=0;x<z;++x){var w=d.$points$[x],u=w.$normalImpulse$*k+w.$tangentImpulse$*m,y=w.$normalImpulse$*n+w.$tangentImpulse$*q;c=e.$m_R$;a=w.$localAnchor1$;var p=c.$col1$.x*a.x+c.$col2$.x*a.y,v=c.$col1$.y*a.x+c.$col2$.y*a.y;c=f.$m_R$;a=w.$localAnchor2$;
var B=c.$col1$.x*a.x+c.$col2$.x*a.y;a=c.$col1$.y*a.x+c.$col2$.y*a.y;e.$m_angularVelocity$-=h*(p*y-v*u);e.$m_linearVelocity$.x-=g*u;e.$m_linearVelocity$.y-=g*y;f.$m_angularVelocity$+=i*(B*y-a*u);f.$m_linearVelocity$.x+=j*u;f.$m_linearVelocity$.y+=j*y;w.$positionImpulse$=0}}else{z=d.$pointCount$;for(x=0;x<z;++x){e=d.$points$[x];e.$normalImpulse$=0;e.$tangentImpulse$=0;e.$positionImpulse$=0}}}},$SolveVelocityConstraints$:function(){for(var a=0,c,b,d,e,f,g,h,j,i=0;i<this.$m_constraintCount$;++i){var k=
this.$m_constraints$[i],n=k.$body1$,m=k.$body2$,q=n.$m_angularVelocity$,x=n.$m_linearVelocity$,z=m.$m_angularVelocity$,w=m.$m_linearVelocity$,u=n.$m_invMass$,y=n.$m_invI$,p=m.$m_invMass$,v=m.$m_invI$,B=k.$normal$.x,A=k.$normal$.y,H=A,G=-B,R=k.$pointCount$;for(a=0;a<R;++a){c=k.$points$[a];f=n.$m_R$;g=c.$localAnchor1$;b=f.$col1$.x*g.x+f.$col2$.x*g.y;d=f.$col1$.y*g.x+f.$col2$.y*g.y;f=m.$m_R$;g=c.$localAnchor2$;e=f.$col1$.x*g.x+f.$col2$.x*g.y;f=f.$col1$.y*g.x+f.$col2$.y*g.y;g=w.x+-z*f-x.x- -q*d;h=w.y+
z*e-x.y-q*b;g=-c.$normalMass$*(g*B+h*A-c.$velocityBias$);h=Math.max(c.$normalImpulse$+g,0);g=h-c.$normalImpulse$;j=g*B;g*=A;x.x-=u*j;x.y-=u*g;q-=y*(b*g-d*j);w.x+=p*j;w.y+=p*g;z+=v*(e*g-f*j);c.$normalImpulse$=h;g=w.x+-z*f-x.x- -q*d;h=w.y+z*e-x.y-q*b;g=c.$tangentMass$*-(g*H+h*G);h=k.$friction$*c.$normalImpulse$;h=Math.max(-h,Math.min(c.$tangentImpulse$+g,h));g=h-c.$tangentImpulse$;j=g*H;g*=G;x.x-=u*j;x.y-=u*g;q-=y*(b*g-d*j);w.x+=p*j;w.y+=p*g;z+=v*(e*g-f*j);c.$tangentImpulse$=h}n.$m_angularVelocity$=
q;m.$m_angularVelocity$=z}},$SolvePositionConstraints$:function(a){for(var c=0,b,d,e=0;e<this.$m_constraintCount$;++e){for(var f=this.$m_constraints$[e],g=f.$body1$,h=f.$body2$,j=g.$m_position$,i=g.$m_rotation$,k=h.$m_position$,n=h.$m_rotation$,m=g.$m_invMass$,q=g.$m_invI$,x=h.$m_invMass$,z=h.$m_invI$,w=f.$normal$.x,u=f.$normal$.y,y=f.$pointCount$,p=0;p<y;++p){var v=f.$points$[p];b=g.$m_R$;d=v.$localAnchor1$;var B=b.$col1$.x*d.x+b.$col2$.x*d.y,A=b.$col1$.y*d.x+b.$col2$.y*d.y;b=h.$m_R$;d=v.$localAnchor2$;
var H=b.$col1$.x*d.x+b.$col2$.x*d.y;b=b.$col1$.y*d.x+b.$col2$.y*d.y;d=(k.x+H-(j.x+B))*w+(k.y+b-(j.y+A))*u+v.$separation$;c=Math.min(c,d);d=-v.$normalMass$*a*Math.max(-6,Math.min(d+0.15,0));var G=v.$positionImpulse$;v.$positionImpulse$=Math.max(G+d,0);d=v.$positionImpulse$-G;v=d*w;d*=u;j.x-=m*v;j.y-=m*d;i-=q*(B*d-A*v);g.$m_R$.$Set$(i);k.x+=x*v;k.y+=x*d;n+=z*(H*d-b*v);h.$m_R$.$Set$(n)}g.$m_rotation$=i;h.$m_rotation$=n}return c>=-0.15},$PostSolve$:function(){for(var a=0;a<this.$m_constraintCount$;++a)for(var c=
this.$m_constraints$[a],b=c.$manifold$,d=0;d<c.$pointCount$;++d){var e=b.$points$[d],f=c.$points$[d];e.$normalImpulse$=f.$normalImpulse$;e.$tangentImpulse$=f.$tangentImpulse$}}};function Xc(a,c,b){var d=0;this.$m_bodyCapacity$=a;this.$m_contactCapacity$=c;this.$m_jointCapacity$=b;this.$m_jointCount$=this.$m_contactCount$=this.$m_bodyCount$=0;this.$m_bodies$=Array(a);for(d=0;d<a;d++)this.$m_bodies$[d]=r;this.$m_contacts$=Array(c);for(d=0;d<c;d++)this.$m_contacts$[d]=r;this.$m_joints$=Array(b);for(d=0;d<b;d++)this.$m_joints$[d]=r}
Xc.prototype.$Solve$=function(a,c){var b=0,d;for(b=0;b<this.$m_bodyCount$;++b){d=this.$m_bodies$[b];if(d.$m_invMass$!=0){d.$m_linearVelocity$.add(new J(a.$dt$*zb(c,new J(d.$m_invMass$*d.$m_force$.x,d.$m_invMass$*d.$m_force$.y)).x,a.$dt$*zb(c,new J(d.$m_invMass$*d.$m_force$.x,d.$m_invMass$*d.$m_force$.y)).y));d.$m_angularVelocity$+=a.$dt$*d.$m_invI$*d.$m_torque$;d.$m_linearVelocity$.scale(d.$m_linearDamping$);d.$m_angularVelocity$*=d.$m_angularDamping$;K(d.$m_position0$,d.$m_position$);d.$m_rotation0$=
d.$m_rotation$}}var e=new Vc(this.$m_contacts$,this.$m_contactCount$);e.$PreSolve$();for(b=0;b<this.$m_jointCount$;++b)this.$m_joints$[b].$PrepareVelocitySolver$();for(b=0;b<a.$iterations$;++b){e.$SolveVelocityConstraints$();for(d=0;d<this.$m_jointCount$;++d)this.$m_joints$[d].$SolveVelocityConstraints$(a)}for(b=0;b<this.$m_bodyCount$;++b){d=this.$m_bodies$[b];if(d.$m_invMass$!=0){d.$m_position$.x+=a.$dt$*d.$m_linearVelocity$.x;d.$m_position$.y+=a.$dt$*d.$m_linearVelocity$.y;d.$m_rotation$+=a.$dt$*
d.$m_angularVelocity$;d.$m_R$.$Set$(d.$m_rotation$)}}for(b=0;b<this.$m_jointCount$;++b);if(Yc)for(Zc=0;Zc<a.$iterations$;++Zc){d=e.$SolvePositionConstraints$(0.2);var f=o;for(b=0;b<this.$m_jointCount$;++b){var g=this.$m_joints$[b].$SolvePositionConstraints$();f=f&&g}if(d&&f)break}e.$PostSolve$();for(b=0;b<this.$m_bodyCount$;++b){d=this.$m_bodies$[b];if(d.$m_invMass$!=0){d.$m_R$.$Set$(d.$m_rotation$);e=d;e.$sMat0$.$Set$(e.$m_rotation0$);for(f=e.$m_shapeList$;f!=r;f=f.$m_next$)f.$Synchronize$(e.$m_position0$,
e.$sMat0$,e.$m_position$,e.$m_R$);d.$m_force$.$Set$(0,0);d.$m_torque$=0}}};var Zc=0;new L;function $c(){this.$inv_dt$=this.$dt$=r;this.$iterations$=0};function ad(a,c,b){this.$m_step$=new $c;this.$m_contactManager$=new Rc(this);this.$m_listener$=r;this.$collisionFilter$=uc;this.$m_jointList$=this.$m_contactList$=this.$m_bodyList$=r;this.$m_jointCount$=this.$m_contactCount$=this.$m_bodyCount$=0;this.$m_bodyDestroyList$=r;this.$m_allowSleep$=b;this.$m_gravity$=c;this.$m_contactManager$.$m_world$=this;this.$m_broadPhase$=new oc(a,this.$m_contactManager$);this.$m_groundBody$=bd(this,new Eb);this.$lastPairs$=[];this.$sleeping$=s}
function bd(a,c){var b=new Xb(c,a);b.$m_prev$=r;if(b.$m_next$=a.$m_bodyList$)a.$m_bodyList$.$m_prev$=b;a.$m_bodyList$=b;++a.$m_bodyCount$;return b}function cd(a,c){if(!(c.$m_flags$&32)){if(c.$m_prev$)c.$m_prev$.$m_next$=c.$m_next$;if(c.$m_next$)c.$m_next$.$m_prev$=c.$m_prev$;if(c==a.$m_bodyList$)a.$m_bodyList$=c.$m_next$;c.$m_flags$|=32;--a.$m_bodyCount$;c.$m_prev$=r;c.$m_next$=a.$m_bodyDestroyList$;a.$m_bodyDestroyList$=c}}
function dd(a){a.$m_contactManager$.$m_destroyImmediate$=o;for(var c=a.$m_bodyDestroyList$;c;){var b=c;c=c.$m_next$;for(var d=b.$m_jointList$;d;){var e=d;d=d.next;var f=a;e=e.$joint$;var g=e.$m_collideConnected$;if(e.$m_prev$)e.$m_prev$.$m_next$=e.$m_next$;if(e.$m_next$)e.$m_next$.$m_prev$=e.$m_prev$;if(e==f.$m_jointList$)f.$m_jointList$=e.$m_next$;var h=e.$m_body1$,j=e.$m_body2$;$b(h);$b(j);if(e.$m_node1$.prev)e.$m_node1$.prev.next=e.$m_node1$.next;if(e.$m_node1$.next)e.$m_node1$.next.prev=e.$m_node1$.prev;
if(e.$m_node1$==h.$m_jointList$)h.$m_jointList$=e.$m_node1$.next;e.$m_node1$.prev=r;e.$m_node1$.next=r;if(e.$m_node2$.prev)e.$m_node2$.prev.next=e.$m_node2$.next;if(e.$m_node2$.next)e.$m_node2$.next.prev=e.$m_node2$.prev;if(e.$m_node2$==j.$m_jointList$)j.$m_jointList$=e.$m_node2$.next;e.$m_node2$.prev=r;e.$m_node2$.next=r;--f.$m_jointCount$;if(g==s)for(e=(h.$m_shapeCount$<j.$m_shapeCount$?h:j).$m_shapeList$;e;e=e.$m_next$)e.$ResetProxy$(f.$m_broadPhase$)}for(b=b.$m_shapeList$;b;){d=b;b=b.$m_next$;
d.$m_proxyId$!=M&&d.$m_body$.$m_world$.$m_broadPhase$.$DestroyProxy$(d.$m_proxyId$)}}a.$m_bodyDestroyList$=r;a.$m_contactManager$.$m_destroyImmediate$=s}
ad.prototype.$Query$=function(a,c,b){var d=[],e=this.$m_broadPhase$,f=[],g=[];qc(e,f,g,a);a=[0];var h=[0];e.$Query$(a,h,f[0],g[0],e.$m_bounds$[0],2*e.$m_proxyCount$,0);e.$Query$(a,h,f[1],g[1],e.$m_bounds$[1],2*e.$m_proxyCount$,1);for(g=f=0;g<e.$m_queryResultCount$&&f<b;++g,++f)d[g]=e.$proxyPool$[e.$m_queryResults$[g]].$userData$;e.$m_queryResultCount$=0;pc(e);b=f;for(e=0;e<b;++e)c[e]=d[e];return b};var Yc=1,Wc=1;function ed(){ye&&(Be[ma(this)]=this)}var ye=s,Be={};ed.prototype.$disposed_$=s;ed.prototype.$dispose$=function(){if(!this.$disposed_$){this.$disposed_$=o;this.$disposeInternal$();if(ye){var a=ma(this);Be.hasOwnProperty(a)||l(Error(this+" did not call the goog.Disposable base constructor or was disposed of after a clearUndisposedObjects call"));delete Be[a]}}};ed.prototype.$disposeInternal$=aa();var fd;function Q(a,c){ed.call(this);this.type=a;this.currentTarget=this.target=c}E(Q,ed);t=Q.prototype;t.$disposeInternal$=function(){delete this.type;delete this.target;delete this.currentTarget};t.$propagationStopped_$=s;t.$returnValue_$=o;t.stopPropagation=function(){this.$propagationStopped_$=o};t.preventDefault=function(){this.$returnValue_$=s};function gd(a,c,b,d,e){Q.call(this,c,e);this.$velocity$=a;this.$ballNumber1$=b;this.$ballNumber2$=d}E(gd,Q);function hd(a,c,b){this.$number$=a;this.$m_ballLocation$=c.$Copy$();this.$m_pocketLocation$=b.$Copy$();this.$m_stepCount$=0}hd.prototype.step=function(){this.$m_stepCount$++;return this.$m_stepCount$};function id(a,c){Q.call(this,jd,c);this.$ballNumber$=a}E(id,Q);var jd="eightball.PocketDropEvent.TYPE";!Ma||$a("9");var kd=Ma&&!$a("8");var Ce=new Function("a","return a");function ld(a,c){a&&this.$init$(a,c)}E(ld,Q);t=ld.prototype;t.target=r;t.relatedTarget=r;t.offsetX=0;t.offsetY=0;t.clientX=0;t.clientY=0;t.screenX=0;t.screenY=0;t.button=0;t.keyCode=0;t.charCode=0;t.ctrlKey=s;t.altKey=s;t.shiftKey=s;t.metaKey=s;t.$platformModifierKey$=s;t.$event_$=r;
t.$init$=function(a,c){var b=this.type=a.type;Q.call(this,b);this.target=a.target||a.srcElement;this.currentTarget=c;var d=a.relatedTarget;if(d){if(Na)try{Ce(d.nodeName)}catch(e){d=r}}else if(b=="mouseover")d=a.fromElement;else if(b=="mouseout")d=a.toElement;this.relatedTarget=d;this.offsetX=a.offsetX!==undefined?a.offsetX:a.layerX;this.offsetY=a.offsetY!==undefined?a.offsetY:a.layerY;this.clientX=a.clientX!==undefined?a.clientX:a.pageX;this.clientY=a.clientY!==undefined?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||(b=="keypress"?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.$platformModifierKey$=Ha?a.metaKey:a.ctrlKey;this.state=a.state;this.$event_$=a;delete this.$returnValue_$;delete this.$propagationStopped_$};
t.stopPropagation=function(){ld.$superClass_$.stopPropagation.call(this);if(this.$event_$.stopPropagation)this.$event_$.stopPropagation();else this.$event_$.cancelBubble=o};t.preventDefault=function(){ld.$superClass_$.preventDefault.call(this);var a=this.$event_$;if(a.preventDefault)a.preventDefault();else{a.returnValue=s;if(kd)try{if(a.ctrlKey||a.keyCode>=112&&a.keyCode<=123)a.keyCode=-1}catch(c){}}};
t.$disposeInternal$=function(){ld.$superClass_$.$disposeInternal$.call(this);this.relatedTarget=this.currentTarget=this.target=this.$event_$=r};function md(){}var nd=0;t=md.prototype;t.key=0;t.$removed$=s;t.$callOnce$=s;t.$init$=function(a,c,b,d,e,f){if(ja(a))this.$isFunctionListener_$=o;else if(a&&a.handleEvent&&ja(a.handleEvent))this.$isFunctionListener_$=s;else l(Error("Invalid listener argument"));this.$listener$=a;this.proxy=c;this.src=b;this.type=d;this.capture=!!e;this.$handler$=f;this.$callOnce$=s;this.key=++nd;this.$removed$=s};
t.handleEvent=function(a){if(this.$isFunctionListener_$)return this.$listener$.call(this.$handler$||this.src,a);return this.$listener$.handleEvent.call(this.$listener$,a)};function S(a,c){ed.call(this);this.$maxCount_$=c;this.$freeQueue_$=[];a>this.$maxCount_$&&l(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var b=0;b<a;b++)this.$freeQueue_$.push(this.$createObjectFn_$?this.$createObjectFn_$():{})}E(S,ed);S.prototype.$createObjectFn_$=r;S.prototype.$disposeObjectFn_$=r;S.prototype.getObject=function(){if(this.$freeQueue_$.length)return this.$freeQueue_$.pop();return this.$createObjectFn_$?this.$createObjectFn_$():{}};
function pd(a,c){a.$freeQueue_$.length<a.$maxCount_$?a.$freeQueue_$.push(c):qd(a,c)}function qd(a,c){if(a.$disposeObjectFn_$)a.$disposeObjectFn_$(c);else if(Ja(c))if(ja(c.$dispose$))c.$dispose$();else for(var b in c)delete c[b]}S.prototype.$disposeInternal$=function(){S.$superClass_$.$disposeInternal$.call(this);for(var a=this.$freeQueue_$;a.length;)qd(this,a.pop());delete this.$freeQueue_$};var rd;var sd=(rd="ScriptEngine"in C&&C.ScriptEngine()=="JScript")?C.ScriptEngineMajorVersion()+"."+C.ScriptEngineMinorVersion()+"."+C.ScriptEngineBuildVersion():"0";var td,ud,vd,wd,xd,yd,zd,Ad,Bd,Cd,Dd;
(function(){function a(){return{$count_$:0,$remaining_$:0}}function c(){return[]}function b(){function m(q){return g.call(m.src,m.key,q)}return m}function d(){return new md}function e(){return new ld}var f=rd&&!(Ba(sd,"5.7")>=0),g;yd=function(m){g=m};if(f){td=function(){return h.getObject()};ud=function(m){pd(h,m)};vd=function(){return j.getObject()};wd=function(m){pd(j,m)};xd=function(){return i.getObject()};zd=function(){pd(i,b())};Ad=function(){return k.getObject()};Bd=function(m){pd(k,m)};Cd=
function(){return n.getObject()};Dd=function(m){pd(n,m)};var h=new S(0,600);h.$createObjectFn_$=a;var j=new S(0,600);j.$createObjectFn_$=c;var i=new S(0,600);i.$createObjectFn_$=b;var k=new S(0,600);k.$createObjectFn_$=d;var n=new S(0,600);n.$createObjectFn_$=e}else{td=a;ud=ea;vd=c;wd=ea;xd=b;zd=ea;Ad=d;Bd=ea;Cd=e;Dd=ea}})();function Ed(a,c,b){for(var d in a)c.call(b,a[d],d,a)}function Fd(a,c){for(var b in a)if(!c.call(void 0,a[b],b,a))return s;return o}function Gd(a){var c=0,b;for(b in a)c++;return c}function Id(a){for(var c in a)delete a[c]}var Jd=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"];
function Kd(a){for(var c,b,d=1;d<arguments.length;d++){b=arguments[d];for(c in b)a[c]=b[c];for(var e=0;e<Jd.length;e++){c=Jd[e];Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])}}}function Ld(){var a=arguments.length;if(a==1&&ga(arguments[0]))return Ld.apply(r,arguments[0]);for(var c={},b=0;b<a;b++)c[arguments[b]]=o;return c};var Md={},T={},Nd={},Od={};
function U(a,c,b,d,e){if(c)if(ga(c))for(var f=0;f<c.length;f++)U(a,c[f],b,d,e);else{d=!!d;var g=T;c in g||(g[c]=td());g=g[c];if(!(d in g)){g[d]=td();g.$count_$++}g=g[d];var h=ma(a),j;g.$remaining_$++;if(g[h]){j=g[h];for(f=0;f<j.length;f++){g=j[f];if(g.$listener$==b&&g.$handler$==e){if(g.$removed$)break;return}}}else{j=g[h]=vd();g.$count_$++}f=xd();f.src=a;g=Ad();g.$init$(b,f,a,c,d,e);b=g.key;f.key=b;j.push(g);Md[b]=g;Nd[h]||(Nd[h]=vd());Nd[h].push(g);if(a.addEventListener)(a==C||!a.$customEvent_$)&&
a.addEventListener(c,f,d);else a.attachEvent(Pd(c),f)}else l(Error("Invalid event type"))}function Qd(a,c,b,d,e){if(ga(c))for(var f=0;f<c.length;f++)Qd(a,c[f],b,d,e);else{d=!!d;a:{f=T;if(c in f){f=f[c];if(d in f){f=f[d];a=ma(a);if(f[a]){a=f[a];break a}}}a=r}if(a)for(f=0;f<a.length;f++)if(a[f].$listener$==b&&a[f].capture==d&&a[f].$handler$==e){Rd(a[f].key);break}}}
function Rd(a){if(Md[a]){var c=Md[a];if(!c.$removed$){var b=c.src,d=c.type,e=c.proxy,f=c.capture;if(b.removeEventListener)(b==C||!b.$customEvent_$)&&b.removeEventListener(d,e,f);else b.detachEvent&&b.detachEvent(Pd(d),e);b=ma(b);e=T[d][f][b];if(Nd[b]){var g=Nd[b];Jg(g,c);g.length==0&&delete Nd[b]}c.$removed$=o;e.$needsCleanup_$=o;Sd(d,f,b,e);delete Md[a]}}}
function Sd(a,c,b,d){if(!d.$locked_$&&d.$needsCleanup_$){for(var e=0,f=0;e<d.length;e++)if(d[e].$removed$){var g=d[e].proxy;g.src=r;zd(g);Bd(d[e])}else{e!=f&&(d[f]=d[e]);f++}d.length=f;d.$needsCleanup_$=s;if(f==0){wd(d);delete T[a][c][b];T[a][c].$count_$--;if(T[a][c].$count_$==0){ud(T[a][c]);delete T[a][c];T[a].$count_$--}if(T[a].$count_$==0){ud(T[a]);delete T[a]}}}}
function Td(a){var c,b=0,d=c==r;c=!!c;if(a==r)Ed(Nd,function(g){for(var h=g.length-1;h>=0;h--){var j=g[h];if(d||c==j.capture){Rd(j.key);b++}}});else{a=ma(a);if(Nd[a]){a=Nd[a];for(var e=a.length-1;e>=0;e--){var f=a[e];if(d||c==f.capture){Rd(f.key);b++}}}}}function Pd(a){if(a in Od)return Od[a];return Od[a]="on"+a}
function Ud(a,c,b,d,e){var f=1;c=ma(c);if(a[c]){a.$remaining_$--;a=a[c];if(a.$locked_$)a.$locked_$++;else a.$locked_$=1;try{for(var g=a.length,h=0;h<g;h++){var j=a[h];j&&!j.$removed$&&(f&=Vd(j,e)!==s)}}finally{a.$locked_$--;Sd(b,d,c,a)}}return Boolean(f)}function Vd(a,c){var b=a.handleEvent(c);a.$callOnce$&&Rd(a.key);return b}
yd(function(a,c){if(!Md[a])return o;var b=Md[a],d=b.type,e=T;if(!(d in e))return o;e=e[d];var f,g;fd===undefined&&(fd=Ma&&!C.addEventListener);if(fd){f=c||da("window.event");var h=o in e,j=s in e;if(h){if(f.keyCode<0||f.returnValue!=undefined)return o;a:{var i=s;if(f.keyCode==0)try{f.keyCode=-1;break a}catch(k){i=o}if(i||f.returnValue==undefined)f.returnValue=o}}i=Cd();i.$init$(f,this);f=o;try{if(h){for(var n=vd(),m=i.currentTarget;m;m=m.parentNode)n.push(m);g=e[o];g.$remaining_$=g.$count_$;for(var q=
n.length-1;!i.$propagationStopped_$&&q>=0&&g.$remaining_$;q--){i.currentTarget=n[q];f&=Ud(g,n[q],d,o,i)}if(j){g=e[s];g.$remaining_$=g.$count_$;for(q=0;!i.$propagationStopped_$&&q<n.length&&g.$remaining_$;q++){i.currentTarget=n[q];f&=Ud(g,n[q],d,s,i)}}}else f=Vd(b,i)}finally{if(n){n.length=0;wd(n)}i.$dispose$();Dd(i)}return f}d=new ld(c,this);try{f=Vd(b,d)}finally{d.$dispose$()}return f});function Wd(){ed.call(this)}E(Wd,ed);t=Wd.prototype;t.$customEvent_$=o;t.$parentEventTarget_$=r;t.addEventListener=function(a,c,b,d){U(this,a,c,b,d)};t.removeEventListener=function(a,c,b,d){Qd(this,a,c,b,d)};
t.dispatchEvent=function(a){var c=a.type||a,b=T;if(c in b){if(D(a))a=new Q(a,this);else if(a instanceof Q)a.target=a.target||this;else{var d=a;a=new Q(c,this);Kd(a,d)}d=1;var e;b=b[c];c=o in b;var f;if(c){e=[];for(f=this;f;f=f.$parentEventTarget_$)e.push(f);f=b[o];f.$remaining_$=f.$count_$;for(var g=e.length-1;!a.$propagationStopped_$&&g>=0&&f.$remaining_$;g--){a.currentTarget=e[g];d&=Ud(f,e[g],a.type,o,a)&&a.$returnValue_$!=s}}if(s in b){f=b[s];f.$remaining_$=f.$count_$;if(c)for(g=0;!a.$propagationStopped_$&&
g<e.length&&f.$remaining_$;g++){a.currentTarget=e[g];d&=Ud(f,e[g],a.type,s,a)&&a.$returnValue_$!=s}else for(e=this;!a.$propagationStopped_$&&e&&f.$remaining_$;e=e.$parentEventTarget_$){a.currentTarget=e;d&=Ud(f,e,a.type,s,a)&&a.$returnValue_$!=s}}a=Boolean(d)}else a=o;return a};t.$disposeInternal$=function(){Wd.$superClass_$.$disposeInternal$.call(this);Td(this);this.$parentEventTarget_$=r};function Xd(a,c){ed.call(this);this.$interval_$=a||1;this.$timerObject_$=c||Yd;this.$boundTick_$=pa(this.$tick_$,this);this.$last_$=ra()}E(Xd,Wd);Xd.prototype.enabled=s;var Yd=C.window;t=Xd.prototype;t.$timer_$=r;t.setInterval=function(a){this.$interval_$=a;if(this.$timer_$&&this.enabled){this.stop();this.start()}else this.$timer_$&&this.stop()};
t.$tick_$=function(){if(this.enabled){var a=ra()-this.$last_$;if(a>0&&a<this.$interval_$*0.8)this.$timer_$=this.$timerObject_$.setTimeout(this.$boundTick_$,this.$interval_$-a);else{this.dispatchEvent(Zd);if(this.enabled){this.$timer_$=this.$timerObject_$.setTimeout(this.$boundTick_$,this.$interval_$);this.$last_$=ra()}}}};t.start=function(){this.enabled=o;if(!this.$timer_$){this.$timer_$=this.$timerObject_$.setTimeout(this.$boundTick_$,this.$interval_$);this.$last_$=ra()}};
t.stop=function(){this.enabled=s;if(this.$timer_$){this.$timerObject_$.clearTimeout(this.$timer_$);this.$timer_$=r}};t.$disposeInternal$=function(){Xd.$superClass_$.$disposeInternal$.call(this);this.stop();delete this.$timerObject_$};var Zd="tick";function $d(a,c){if(ja(a))c&&(a=pa(a,c));else if(a&&typeof a.handleEvent=="function")a=pa(a.handleEvent,a);else l(Error("Invalid listener argument"));Yd.setTimeout(a,400)};var ae=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i;function be(a){return a.length==1?"0"+a:a};function ce(a){return de(a||arguments.callee.caller,[])}
function de(a,c){var b=[];if(pb(c,a)>=0)b.push("[...circular reference...]");else if(a&&c.length<50){b.push(ee(a)+"(");for(var d=a.arguments,e=0;e<d.length;e++){e>0&&b.push(", ");var f;f=d[e];switch(typeof f){case "object":f=f?"object":"null";break;case "string":break;case "number":f=String(f);break;case "boolean":f=f?"true":"false";break;case "function":f=(f=ee(f))?f:"[fn]";break;default:f=typeof f}f.length>40&&(f=f.substr(0,40)+"...");b.push(f)}c.push(a);b.push(")\n");try{b.push(de(a.caller,c))}catch(g){b.push("[exception trying to get caller]\n")}}else a?
b.push("[...long stack...]"):b.push("[end]");return b.join("")}function ee(a){a=String(a);if(!fe[a]){var c=/function ([^\(]+)/.exec(a);fe[a]=c?c[1]:"[Anonymous]"}return fe[a]}var fe={};function ge(a,c,b,d,e){this.reset(a,c,b,d,e)}ge.prototype.$sequenceNumber_$=0;ge.prototype.$exception_$=r;ge.prototype.$exceptionText_$=r;var he=0;ge.prototype.reset=function(a,c,b,d,e){this.$sequenceNumber_$=typeof e=="number"?e:he++;this.$time_$=d||ra();this.$level_$=a;this.$msg_$=c;this.$loggerName_$=b;delete this.$exception_$;delete this.$exceptionText_$};ge.prototype.$setLevel$=function(a){this.$level_$=a};function ie(a){this.$name_$=a}ie.prototype.$parent_$=r;ie.prototype.$level_$=r;ie.prototype.$handlers_$=r;function je(a,c){this.name=a;this.value=c}je.prototype.toString=ba("name");var ke=new je("INFO",800),le=new je("CONFIG",700);t=ie.prototype;t.getParent=ba("$parent_$");t.$setLevel$=function(a){this.$level_$=a};function me(a){if(a.$level_$)return a.$level_$;if(a.$parent_$)return me(a.$parent_$);nb("Root logger has no level set.");return r}
t.log=function(a,c,b){if(a.value>=me(this).value){a=this.$getLogRecord$(a,c,b);C.console&&C.console.markTimeline&&C.console.markTimeline("log:"+a.$msg_$);for(c=this;c;){b=c;var d=a;if(b.$handlers_$)for(var e=0,f=void 0;f=b.$handlers_$[e];e++)f(d);c=c.getParent()}}};
t.$getLogRecord$=function(a,c,b){var d=new ge(a,String(c),this.$name_$);if(b){d.$exception_$=b;var e;var f=arguments.callee.caller;try{var g;var h=da("window.location.href");if(D(b))g={message:b,name:"Unknown error",lineNumber:"Not available",fileName:h,stack:"Not available"};else{var j,i,k=s;try{j=b.lineNumber||b.$line$||"Not available"}catch(n){j="Not available";k=o}try{i=b.fileName||b.filename||b.sourceURL||h}catch(m){i="Not available";k=o}g=k||!b.lineNumber||!b.fileName||!b.stack?{message:b.message,
name:b.name,lineNumber:j,fileName:i,stack:b.stack||"Not available"}:b}e="Message: "+ta(g.message)+'\nUrl: <a href="view-source:'+g.fileName+'" target="_new">'+g.fileName+"</a>\nLine: "+g.lineNumber+"\n\nBrowser stack:\n"+ta(g.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+ta(ce(f)+"-> ")}catch(q){e="Exception trying to expose exception! You win, we lose. "+q}d.$exceptionText_$=e}return d};t.info=function(a,c){this.log(ke,a,c)};var ne=r;
function oe(){if(!ne){ne=new ie("");ne.$setLevel$(le)}return ne};function pe(a,c,b,d){this.$x0$=a;this.$y0$=c;this.$x1$=b;this.$y1$=d};function qe(a,c){this.width=a;this.height=c}function re(a,c){if(a==c)return o;if(!a||!c)return s;return a.width==c.width&&a.height==c.height}qe.prototype.toString=function(){return"("+this.width+" x "+this.height+")"};qe.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};qe.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};
qe.prototype.scale=function(a){this.width*=a;this.height*=a;return this};function V(a,c){if(a instanceof V)this.$array_$=a.toArray();else{var b;if(b=ha(a))a:{for(var d=b=0;d<a.length;d++){if(!ha(a[d])||b>0&&a[d].length!=b){b=s;break a}for(var e=0;e<a[d].length;e++)if(!ia(a[d][e])){b=s;break a}if(b==0)b=a[d].length}b=b!=0}if(b)this.$array_$=Kg(a);else if(a instanceof qe)this.$array_$=se(a.height,a.width);else if(ia(a)&&ia(c)&&a>0&&c>0)this.$array_$=se(a,c);else l(Error("Invalid argument(s) for Matrix contructor"))}this.$size_$=new qe(this.$array_$[0].length,this.$array_$.length)}
function te(a,c,b){for(var d=0;d<a.$size_$.height;d++)for(var e=0;e<a.$size_$.width;e++)c.call(b,a.$array_$[d][e],d,e,a)}function ue(a,c){var b=new V(a.$size_$);te(a,function(d,e,f){b.$array_$[e][f]=c.call(void 0,d,e,f,a)});return b}function se(a,c){for(var b=[],d=0;d<a;d++){b[d]=[];for(var e=0;e<c;e++)b[d][e]=0}return b}t=V.prototype;t.add=function(a){re(this.$size_$,a.$size_$)||l(Error("Matrix summation is only supported on arrays of equal size"));return ue(this,function(c,b,d){return c+a.$array_$[b][d]})};
function ve(a,c,b){if(!(c>=0&&c<a.$size_$.height&&b>=0&&b<a.$size_$.width))return r;return a.$array_$[c][b]}t.multiply=function(a){if(a instanceof V){this.$size_$.width!=a.$size_$.height&&l(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns."));return we(this,a)}else if(ia(a))return xe(this,a);else l(Error("A matrix can only be multiplied by a number or another matrix."))};
t.$subtract$=function(a){re(this.$size_$,a.$size_$)||l(Error("Matrix subtraction is only supported on arrays of equal size."));return ue(this,function(c,b,d){return c-a.$array_$[b][d]})};t.toArray=ba("$array_$");t.toString=function(){var a=0;te(this,function(b){b=String(b).length;b>a&&(a=b)});var c=[];ib(this.$array_$,function(b){c.push("[ ");ib(b,function(d){d=String(d);c.push(Array(a-d.length+1).join(" ")+d+" ")});c.push("]\n")});return c.join("")};
function we(a,c){var b=new V(a.$size_$.height,c.$size_$.width);te(b,function(d,e,f){for(var g=d=0;g<this.$size_$.width;g++)d+=ve(this,e,g)*ve(c,g,f);e>=0&&e<b.$size_$.height&&f>=0&&f<b.$size_$.width||l(Error("Index out of bounds when setting matrix value, ("+e+","+f+") in size ("+b.$size_$.height+","+b.$size_$.width+")"));b.$array_$[e][f]=d},a);return b}function xe(a,c){return ue(a,function(b){return b*c})};var Mg=!Ma||$a("9");!Na&&!Ma||Ma&&$a("9")||Na&&$a("3.5");Ma&&$a("9");function Ng(a){var c;c=(c=a.className)&&typeof c.split=="function"?c.split(/\s+/):[];var b;b=Lg(arguments,1);for(var d=0,e=0;e<b.length;e++)if(!(pb(c,b[e])>=0)){c.push(b[e]);d++}b=d==b.length;a.className=c.join(" ");return b};function Og(a,c){Ed(c,function(b,d){if(d=="style")a.style.cssText=b;else if(d=="class")a.className=b;else if(d=="for")a.htmlFor=b;else if(d in Pg)a.setAttribute(Pg[d],b);else a[d]=b})}var Pg={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};
function Qg(){var a=arguments,c=a[0],b=a[1];if(!Mg&&b&&(b.name||b.type)){c=["<",c];b.name&&c.push(' name="',ta(b.name),'"');if(b.type){c.push(' type="',ta(b.type),'"');var d={};Kd(d,b);b=d;delete b.type}c.push(">");c=c.join("")}c=document.createElement(c);if(b)if(D(b))c.className=b;else ga(b)?Ng.apply(r,[c].concat(b)):Og(c,b);a.length>2&&Rg(document,c,a);return c}
function Rg(a,c,b){function d(g){g&&c.appendChild(D(g)?a.createTextNode(g):g)}for(var e=2;e<b.length;e++){var f=b[e];ha(f)&&!(Ja(f)&&f.nodeType>0)?ib(Sg(f)?Kg(f):f,d):d(f)}}function Sg(a){if(a&&typeof a.length=="number")if(Ja(a))return typeof a.item=="function"||typeof a.item=="string";else if(ja(a))return typeof a.item=="function";return s};function ze(a,c,b,d){this.top=a;this.right=c;this.bottom=b;this.left=d}ze.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"};function Tg(a,c){D("display")?Ae(a,c,"display"):Ed("display",qa(Ae,a))}function Ae(a,c,b){a.style[Ua(b)]=c};var Ug;function Vg(){if(Ug){for(var a=Ug,c;c=a.firstChild;)a.removeChild(c);Tg(Ug,"none")}}function Wg(a){if(Ug){Tg(Ug,"block");a=Qg("div",r,ta(a.$msg_$));Ug.appendChild(a)}};function De(){this.$m_count$=0;this.$m_values$=[];this.$m_fps$=this.$m_lastTick$=this.$m_sum$=0};function Ee(a,c,b){ed.call(this);this.$m_cueLine$=this.$m_lastMouseDown$=this.$m_lastMouse$=r;this.$m_strikePower$=0;this.$m_isCueVisible$=o;this.$gameTableBounds$=this.$gameTableOffset$=r;this.$m_bombPulseAngle$=0;this.$m_bombPulseInc$=0.12;this.$m_bombNumber$=-1;this.$_isBombIgnited$=s;this.$m_balls$={};this.$m_fpsLogger$=new De;this.$m_droppingBalls$=[];var d=this,e=oe();this.$_isCueHit$=this.$_isBreak$=s;this.$m_cueImage$=new Image;this.$m_cueImage$.onload=function(){Fe(d)};this.$m_cueImage$.src=
b.cue;this.$m_ballVignetteImage$=new Image;this.$m_ballVignetteImage$.src=b.ballvignette;this.$m_ballNumbers$=new Image;this.$m_ballNumbers$.src=b.ball_numbers;this.$m_canvasElement$=a;this.$m_cueCanvasElement$=c;this.$m_context$=this.$m_canvasElement$.getContext("2d");this.$m_cueCanvasContext$=this.$m_cueCanvasElement$.getContext("2d");this.$m_canvasElement$.setAttribute("width",Ge*2+W*4);this.$m_canvasElement$.setAttribute("height",He*2+W*4);this.$m_centerOffset$=new J(Ge+W*2,He+W*2);Ie(this);this.$m_context$.translate(this.$m_centerOffset$.x,
this.$m_centerOffset$.y);this.$m_isMouseDown$=s;$(this.$m_cueCanvasElement$).mousedown(function(){if(d.$m_lastMouse$&&d.$m_balls$[0]){d.$m_isMouseDown$=o;d.$m_lastMouseDown$=d.$m_lastMouse$;d.$m_cueLine$=new pe(d.$m_balls$[0].$m_position$.x,d.$m_balls$[0].$m_position$.y,d.$m_lastMouseDown$.x,d.$m_lastMouseDown$.y);d.dispatchEvent(new Q(Je,d))}});$(this.$m_cueCanvasElement$).mouseup(function(){d.$m_isMouseDown$=s;if(d.$m_isCueVisible$&&d.$m_strikePower$>0.01){Ke(d);if(d.$m_cueLine$&&d.$m_balls$[0]){var f=
new J(d.$m_cueLine$.$x1$-d.$m_cueLine$.$x0$,d.$m_cueLine$.$y1$-d.$m_cueLine$.$y0$);yb(f);f.scale(800*d.$m_strikePower$+100);d.dispatchEvent(new gd(I(f),"CUESTICK",-1,-1,d));d.$_isCueHit$=o;K(d.$m_balls$[0].$m_linearVelocity$,f);$b(d.$m_balls$[0])}Fe(d);d.dispatchEvent(new Q(Le,d))}});$(this.$m_cueCanvasElement$).mousemove(function(f){if(d.$m_isCueVisible$){f=new F(f.pageX,f.pageY);var g=new F($(d.$m_canvasElement$).offset().left,$(d.$m_canvasElement$).offset().top);f=f.$subtract$(g);d.$m_lastMouse$=
f.$subtract$(d.$m_centerOffset$);if(d.$m_isMouseDown$){f=new pe(d.$m_lastMouseDown$.x,d.$m_lastMouseDown$.y,d.$m_lastMouse$.x,d.$m_lastMouse$.y);g=f.$x1$-f.$x0$;var h=f.$y1$-f.$y0$;g=Math.min(Math.sqrt(g*g+h*h),Me);h=Ne(d,d.$m_cueLine$);f=Ne(d,f);d.$m_strikePower$=g==0?0:g/Me;Vg();e.info("Allowed Angle Range: "+Math.round(h-90)+" to "+Math.round(h+90));e.info("Strike Angle: "+Math.round(f));e.info("Strike Power: "+d.$m_strikePower$);Fe(d,d.$m_lastMouseDown$,g)}else Fe(d,d.$m_lastMouse$,0)}});$(this.$m_cueCanvasElement$).mouseleave(function(){d.$m_lastMouse$=
r;d.$m_isMouseDown$=s});this.$_timer$=new Xd(Oe);U(this.$_timer$,Zd,this.$_step$,undefined,this);this.$_timer$.start()}E(Ee,Wd);Ee.prototype.$resume$=function(){this.$_timer$&&(this.$_timer$.enabled||this.$_timer$.start())};Ee.prototype.pause=function(){this.$_timer$&&this.$_timer$.enabled&&this.$_timer$.stop()};function Pe(a){return Fd(a.$m_balls$,function(c,b){return b<=0})}
function Ke(a){var c=new Xd(50);U(c,Zd,function(){Tg(this.$m_cueCanvasElement$,"none");c.$dispose$()},undefined,a);c.start();a.$m_isCueVisible$=s}function Qe(a){Tg(a.$m_cueCanvasElement$,"block");a.$m_isCueVisible$=o;Re(a);Fe(a,a.$m_lastMouse$,0)}
function Fe(a,c,b){if(a.$m_cueImage$!=r&&a.$m_cueImage$.complete){a.$m_cueCanvasContext$.setTransform(1,0,0,1,0,0);a.$m_cueCanvasContext$.clearRect(0,0,a.$m_cueCanvasElement$.width,a.$m_cueCanvasElement$.height);a.$gameTableOffset$=r;if(a.$m_isCueVisible$&&c&&a.$m_balls$[0]){var d=Se(a,a.$m_balls$[0].$m_position$.x,a.$m_balls$[0].$m_position$.y),e=Math.round(d.x);d=Math.round(d.y);var f=c.x-a.$m_balls$[0].$m_position$.x,g=a.$m_balls$[0].$m_position$.y-c.y,h=Math.atan2(g,f)*-1+Math.PI;g=Math.sqrt(Math.pow(Math.abs(a.$m_balls$[0].$m_position$.x-
c.x),2)+Math.pow(g,2))/5;f/=g;c=(c.y-a.$m_balls$[0].$m_position$.y)/g;a.$m_cueCanvasContext$.lineWidth=2;a.$m_cueCanvasContext$.fillStyle=a.$m_isMouseDown$?a.$m_cueCanvasContext$.strokeStyle=Te:a.$m_cueCanvasContext$.strokeStyle=Ue;var j,i,k,n;if(a.$gameTableBounds$==r){var m=Se(a,0,0);a.$gameTableBounds$=new ze(m.y-180,m.x+380,m.y+180,m.x-380)}for(m=4;m<g;m++){k=e+f*m;n=d+c*m;if(m%2==0){for(var q=1;q<15;q++)if(q in a.$m_balls$){j=Se(a,a.$m_balls$[q].$m_position$.x,a.$m_balls$[q].$m_position$.y);
j=Math.sqrt(Math.pow(j.x-k,2)+Math.pow(j.y-n,2));if(j<=Ve+10){i=o;break}}if(!i&&(k<a.$gameTableBounds$.left||k>a.$gameTableBounds$.right||n<a.$gameTableBounds$.top||n>a.$gameTableBounds$.bottom))i=o;if(i)break;else{a.$m_cueCanvasContext$.beginPath();a.$m_cueCanvasContext$.moveTo(k,n)}}else{a.$m_cueCanvasContext$.lineTo(k,n);a.$m_cueCanvasContext$.stroke()}}if(g>4){a.$m_cueCanvasContext$.beginPath();a.$m_cueCanvasContext$.arc(k,n,4,0,2*Math.PI,s);a.$m_cueCanvasContext$.fill()}a.$m_cueCanvasContext$.translate(e,
d);a.$m_cueCanvasContext$.rotate(h);a.$m_cueCanvasContext$.drawImage(a.$m_cueImage$,We+b,Xe)}}}function Se(a,c,b){if(a.$gameTableOffset$==r){a.$gameTableOffset$=new F($(a.$m_canvasElement$).offset().left,$(a.$m_canvasElement$).offset().top);a.$gameTableOffset$.x+=a.$m_canvasElement$.width/2;a.$gameTableOffset$.y+=a.$m_canvasElement$.height/2}return{x:a.$gameTableOffset$.x+c,y:a.$gameTableOffset$.y+b}}
function Ne(a,c){var b=Math.atan2(c.$y1$-c.$y0$,c.$x0$-c.$x1$)*-180/Math.PI;b<0&&(b=360-b*-1);return b}
function Ie(a){var c=new Bb;c.$minVertex$.$Set$(-1E3,-1E3);c.$maxVertex$.$Set$(1E3,1E3);a.$m_world$=new ad(c,new J(0,0),o);c=a.$m_world$;var b=a.$m_centerOffset$,d=new Eb;d.$restitution$=1;d.$friction$=1;var e,f;e=new Kb;f=[[-b.x,-b.y+W*2.5],[-b.x+W*2,-b.y+W*4.5],[-b.x+W*2,b.y-W*4.5],[-b.x,b.y-W*2.5]];Lb(e,f);Fb(d,e);e=new Kb;f=(new V(f)).multiply(Ye).toArray().reverse();Lb(e,f);Fb(d,e);f=[[-b.x+W*2.3,-b.y],[-b.x+W*4.5,-b.y+W*2],[-W*2.3,-b.y+W*2],[-W*1.5,-b.y]].reverse();e=new Kb;Lb(e,f);Fb(d,e);
e=new Kb;f=(new V(f)).multiply(Ye).toArray().reverse();Lb(e,f);Fb(d,e);e=new Kb;f=(new V(f)).multiply(Ze).toArray();Lb(e,f);Fb(d,e);e=new Kb;f=(new V(f)).multiply(Ye).toArray().reverse();Lb(e,f);Fb(d,e);d.$userData$=[$e];bd(c,d);c=a.$m_world$;b=a.$m_centerOffset$;d=Array(6);e=[[b.x-21,b.y-21]];d[0]=af(c,e[0][0],e[0][1]);e=(new V(e)).multiply(Ye).toArray();d[1]=af(c,e[0][0],e[0][1]);e=(new V(e)).multiply(Ze).toArray();d[2]=af(c,e[0][0],e[0][1]);e=(new V(e)).multiply(Ye).toArray();d[3]=af(c,e[0][0],
e[0][1]);e[0][0]=0;e[0][1]=b.y-12;d[4]=af(c,e[0][0],e[0][1]);e=(new V(e)).multiply(Ze).toArray();d[5]=af(c,e[0][0],e[0][1]);bf(a)}function bf(a){a.$_isBreak$=o;cf(a);Re(a);for(var c=Ve,b=1,d=0;d<5;d++)for(var e=d+1,f=0.5*Ge+d*c*Math.sqrt(3),g=-d*c,h=0;h<e;h++){a.$m_balls$[b]=df(a,b,f,g+h*c*2);b++}}function Re(a){a.$m_balls$[0]||(a.$m_balls$[0]=df(a,0,-0.5*Ge,0))}function cf(a){Ed(a.$m_balls$,function(c){cd(this.$m_world$,c)},a);Id(a.$m_balls$);qb(a.$m_droppingBalls$);dd(a.$m_world$)}
function df(a,c,b,d){var e=new Jb;e.$density$=5;e.$radius$=Ve;e.$restitution$=0.95;e.$friction$=0.2;var f=new Eb;Fb(f,e);f.position.$Set$(b,d);f.$linearDamping$=0.018;f.$angularDamping$=0.12;f.$userData$=[ef,c,new J(Ve,Ve),new F(Ve,Ve)];return bd(a.$m_world$,f)}function ff(a){var c=a.$m_balls$[a.$m_bombNumber$];Ed(a.$m_balls$,function(b){b.$m_linearVelocity$.add(new J(b.$m_position$.x-c.$m_position$.x,b.$m_position$.y-c.$m_position$.y));$b(b)},a);Ke(a);gf(a,a.$m_bombNumber$)}
function Xg(a,c){c===undefined&&(c=o);c?a.$_timer$.setInterval(Oe):a.$_timer$.setInterval(1)}function hf(a,c){if(c!==undefined){var b;if(c){b=new J(Math.random()-0.5,Math.random()-0.5);yb(b);b.scale(100)}else b=new J;a.$m_world$.$m_gravity$=b;Ed(a.$m_balls$,function(d){$b(d)})}return I(a.$m_world$.$m_gravity$)==0}
Ee.prototype.$_step$=function(){var a=this.$m_fpsLogger$,c=ra();if(a.$m_lastTick$>0){var b=c-a.$m_lastTick$;b/=1E3;a.$m_count$++;if(a.$m_values$.length<10){a.$m_values$.push(b);a.$m_sum$+=b;a.$m_fps$=a.$m_count$/a.$m_sum$}else{var d=a.$m_count$%a.$m_values$.length;a.$m_sum$-=a.$m_values$[d];a.$m_values$[d]=b;a.$m_sum$+=a.$m_values$[d];a.$m_fps$=a.$m_values$.length/a.$m_sum$}}a.$m_lastTick$=c;a=this.$m_world$;c=1/30;var e,f;a.$m_step$.$dt$=c;a.$m_step$.$iterations$=1;a.$m_step$.$inv_dt$=c>0?1/c:0;
a.$m_positionIterationCount$=0;b=a.$m_contactManager$;for(d=b.$m_world$.$m_contactList$;d!=r;){var g=d;d=d.$m_next$;g.$m_flags$&2&&Sc(b,g)}dd(a);var h;for(b=a.$m_contactManager$.$m_world$.$m_contactList$;b!=r;b=b.$m_next$)if(!((b.$m_shape1$.$m_body$.$m_flags$&N)==N&&(b.$m_shape2$.$m_body$.$m_flags$&N)==N)){d=b.$m_manifoldCount$;b.$Evaluate$();g=b.$m_manifoldCount$;if(d==0&&g>0){d=b.$m_shape1$.$m_body$;g=b.$m_shape2$.$m_body$;h=b.$m_node1$;e=b.$m_node2$;h.$contact$=b;h.$other$=g;h.prev=r;h.next=d.$m_contactList$;
if(h.next!=r)h.next.prev=b.$m_node1$;d.$m_contactList$=b.$m_node1$;e.$contact$=b;e.$other$=d;e.prev=r;e.next=g.$m_contactList$;if(e.next!=r)e.next.prev=e;g.$m_contactList$=e}else if(d>0&&g==0){d=b.$m_shape1$.$m_body$;g=b.$m_shape2$.$m_body$;h=b.$m_node1$;e=b.$m_node2$;if(h.prev)h.prev.next=h.next;if(h.next)h.next.prev=h.prev;if(h==d.$m_contactList$)d.$m_contactList$=h.next;h.prev=r;h.next=r;if(e.prev)e.prev.next=e.next;if(e.next)e.next.prev=e.prev;if(e==g.$m_contactList$)g.$m_contactList$=e.next;
e.prev=r;e.next=r}}b=new Xc(a.$m_bodyCount$,a.$m_contactCount$,a.$m_jointCount$);for(e=a.$m_bodyList$;e!=r;e=e.$m_next$)e.$m_flags$&=-5;for(d=a.$m_contactList$;d!=r;d=d.$m_next$)d.$m_flags$&=-2;for(d=a.$m_jointList$;d!=r;d=d.$m_next$)d.$m_islandFlag$=s;d=Array(a.$m_bodyCount$);for(g=0;g<a.$m_bodyCount$;g++)d[g]=r;for(g=a.$m_bodyList$;g!=r;g=g.$m_next$)if(!(g.$m_flags$&(Zb|4|N|gc))){h=b;h.$m_bodyCount$=0;h.$m_contactCount$=0;h=h.$m_jointCount$=0;d[h++]=g;for(g.$m_flags$|=4;h>0;){f=e=d[--h];b.$m_bodies$[b.$m_bodyCount$++]=
f;e.$m_flags$&=~N;if(!(e.$m_flags$&Zb)){for(var j=e.$m_contactList$;j!=r;j=j.next)if(!(j.$contact$.$m_flags$&1)){f=j.$contact$;b.$m_contacts$[b.$m_contactCount$++]=f;j.$contact$.$m_flags$|=1;f=j.$other$;if(!(f.$m_flags$&4)){d[h++]=f;f.$m_flags$|=4}}for(e=e.$m_jointList$;e!=r;e=e.next)if(e.$joint$.$m_islandFlag$!=o){f=e.$joint$;b.$m_joints$[b.$m_jointCount$++]=f;e.$joint$.$m_islandFlag$=o;f=e.$other$;if(!(f.$m_flags$&4)){d[h++]=f;f.$m_flags$|=4}}}}b.$Solve$(a.$m_step$,a.$m_gravity$);a.$m_positionIterationCount$=
Math.max(a.$m_positionIterationCount$,Zc);if(a.$m_allowSleep$){h=a;e=b;f=c;j=0;var i=void 0,k=Number.MAX_VALUE,n=Db*Db;for(j=0;j<e.$m_bodyCount$;++j){i=e.$m_bodies$[j];if(i.$m_invMass$!=0){if((i.$m_flags$&ac)==0)k=i.$m_sleepTime$=0;if((i.$m_flags$&ac)==0||i.$m_angularVelocity$*i.$m_angularVelocity$>n||wb(i.$m_linearVelocity$,i.$m_linearVelocity$)>0.09)k=i.$m_sleepTime$=0;else{i.$m_sleepTime$+=f;k=Math.min(k,i.$m_sleepTime$)}}}if(k>=0.5){for(j=0;j<e.$m_bodyCount$;++j){i=e.$m_bodies$[j];i.$m_flags$|=
N}e=o}else e=s;h.$sleeping$=e}for(h=0;h<b.$m_bodyCount$;++h){e=b.$m_bodies$[h];e.$m_flags$&Zb&&(e.$m_flags$&=-5);if((e.$m_flags$&gc)==gc&&a.$m_listener$&&a.$m_listener$.$NotifyBoundaryViolated$(e)==1){cd(a,e);b.$m_bodies$[h]=r}}}a.$lastPairs$=a.$m_broadPhase$.$Commit$();if(this.$m_balls$[this.$m_bombNumber$]||!this.$m_world$.$sleeping$){this.$m_context$.clearRect(-this.$m_centerOffset$.x,-this.$m_centerOffset$.y,2*this.$m_centerOffset$.x,2*this.$m_centerOffset$.y);jf(this);kf(this,this.$m_world$.$lastPairs$);
lf(this)}};
function kf(a,c){var b=0,d=0,e=-1,f=-1,g=0;ib(c,function(i){var k=r,n=r;if(i.$m_shape1$.$m_body$.$m_userData$==mf){k=i.$m_shape1$.$m_body$;n=i.$m_shape2$.$m_body$}else if(i.$m_shape2$.$m_body$.$m_userData$==mf){k=i.$m_shape2$.$m_body$;n=i.$m_shape1$.$m_body$}if(k!=r){var m=n.$m_userData$[1];a.$m_droppingBalls$.push(new hd(m,n.$m_position$,k.$m_position$));gf(a,m);a.dispatchEvent(new id(m,a))}k=[i.$m_shape1$.$m_body$.$m_userData$[0],i.$m_shape2$.$m_body$.$m_userData$[0]];ob.sort.call(k,ub);if(k[0]==
ef){e=i.$m_shape1$.$m_body$.$m_userData$[1];if(k[1]==ef){d++;f=i.$m_shape2$.$m_body$.$m_userData$[1];g+=I(i.$m_shape1$.$m_body$.$m_linearVelocity$);g+=I(i.$m_shape2$.$m_body$.$m_linearVelocity$)}else if(k[1]==$e){b++;g+=I(i.$m_shape1$.$m_body$.$m_linearVelocity$);g+=I(i.$m_shape2$.$m_body$.$m_linearVelocity$)}}});var h=b>0||d>0?g/(2*(d+b)):0;if(d>0){var j="BALL";if(a.$_isBreak$){j="BREAK";a.$_isBreak$=s}else if(a.$_isCueHit$){j="CUEBALL";a.$_isCueHit$=s}a.dispatchEvent(new gd(h,j,e,f,a))}b>0&&a.dispatchEvent(new gd(h,
"WALL",e,f,a))}function gf(a,c){var b=a.$m_balls$[c];Rb(b);b.$m_position$.$Set$(5E3,5E3);delete a.$m_balls$[c]}
function jf(a){for(ib(a.$m_droppingBalls$,a.$_drawDroppingBall$,a);sb(a.$m_droppingBalls$,function(c){return c.$m_stepCount$>=5}););nf(a);Ed(a.$m_balls$,function(c){var b=c.$m_shapeList$,d=c.$m_userData$[1],e=this.$m_bombNumber$==d;this.$m_context$.fillStyle=e?this.$_isBombIgnited$?"rgba(237,218,193,0.5)":of:pf[d];this.$m_context$.beginPath();this.$m_context$.arc(b.$m_position$.x,b.$m_position$.y,b.$m_radius$,0,2*Math.PI,s);this.$m_context$.fill();if(d>0){var f=new F(0,0),g=new F(0,0);this.$m_context$.save();
this.$m_context$.beginPath();this.$m_context$.arc(b.$m_position$.x,b.$m_position$.y,b.$m_radius$,0,Math.PI*2,o);this.$m_context$.clip();var h=c.$m_userData$[2];h.add(new J(0.03*c.$m_linearVelocity$.x,0.03*c.$m_linearVelocity$.y));var j=c.$m_userData$[3],i=b.$m_radius$-h.x,k=b.$m_radius$-h.y,n=Math.sqrt(Math.pow(i,2)+Math.pow(k,2));i=Math.atan2(k,i);n>b.$m_radius$*3&&K(h,j);c=c.$m_position$.$Copy$();f.x=c.x+h.x-b.$m_radius$;f.y=c.y+h.y-b.$m_radius$;j.x=h.x+Math.sin(Math.PI*2.5-i)*b.$m_radius$*2.7;
j.y=h.y+Math.cos(Math.PI*2.5-i)*b.$m_radius$*2.7;g.x=c.x+j.x-b.$m_radius$;g.y=c.y+j.y-b.$m_radius$;if(!e&&d>8){this.$m_context$.fillStyle=pf[0];k=new F(0,0);var m=new F(0,0),q=new F(0,0),x=new F(0,0);k.x=h.x+Math.sin(Math.PI*-0.7-i)*b.$m_radius$+c.x-b.$m_radius$;k.y=h.y+Math.cos(Math.PI*-0.7-i)*b.$m_radius$+c.y-b.$m_radius$;m.x=h.x+Math.sin(Math.PI*-0.7-i)*b.$m_radius$*2+c.x-b.$m_radius$;m.y=h.y+Math.cos(Math.PI*-0.7-i)*b.$m_radius$*2+c.y-b.$m_radius$;q.x=j.x+Math.sin(Math.PI*0.7-i)*b.$m_radius$*
2+c.x-b.$m_radius$;q.y=j.y+Math.cos(Math.PI*0.7-i)*b.$m_radius$*2+c.y-b.$m_radius$;x.x=j.x+Math.sin(Math.PI*0.7-i)*b.$m_radius$+c.x-b.$m_radius$;x.y=j.y+Math.cos(Math.PI*0.7-i)*b.$m_radius$+c.y-b.$m_radius$;this.$m_context$.beginPath();this.$m_context$.moveTo(k.x,k.y);this.$m_context$.lineTo(m.x,m.y);this.$m_context$.lineTo(q.x,q.y);this.$m_context$.lineTo(x.x,x.y);this.$m_context$.fill();k.x=h.x+Math.sin(Math.PI*-0.3-i)*b.$m_radius$+c.x-b.$m_radius$;k.y=h.y+Math.cos(Math.PI*-0.3-i)*b.$m_radius$+
c.y-b.$m_radius$;m.x=h.x+Math.sin(Math.PI*-0.3-i)*b.$m_radius$*2+c.x-b.$m_radius$;m.y=h.y+Math.cos(Math.PI*-0.3-i)*b.$m_radius$*2+c.y-b.$m_radius$;q.x=j.x+Math.sin(Math.PI*0.3-i)*b.$m_radius$*2+c.x-b.$m_radius$;q.y=j.y+Math.cos(Math.PI*0.3-i)*b.$m_radius$*2+c.y-b.$m_radius$;x.x=j.x+Math.sin(Math.PI*0.3-i)*b.$m_radius$+c.x-b.$m_radius$;x.y=j.y+Math.cos(Math.PI*0.3-i)*b.$m_radius$+c.y-b.$m_radius$;this.$m_context$.beginPath();this.$m_context$.moveTo(k.x,k.y);this.$m_context$.lineTo(m.x,m.y);this.$m_context$.lineTo(q.x,
q.y);this.$m_context$.lineTo(x.x,x.y);this.$m_context$.fill()}d*=9;e&&(d=0);this.$m_context$.drawImage(this.$m_ballNumbers$,0,d,9,9,f.x-4,f.y-4,9,9);n>b.$m_radius$&&this.$m_context$.drawImage(this.$m_ballNumbers$,0,d,9,9,g.x-4,g.y-4,9,9);this.$m_context$.restore()}this.$m_context$.drawImage(this.$m_ballVignetteImage$,b.$m_position$.x-b.$m_radius$-2,b.$m_position$.y-b.$m_radius$-2)},a)}
Ee.prototype.$_drawDroppingBall$=function(a){a.step();if(!(a.$m_stepCount$>=5)){var c=a.$m_pocketLocation$.$Copy$();c.$subtract$(a.$m_ballLocation$);c.scale(a.$m_stepCount$/5);c.add(a.$m_ballLocation$);var b,d=pf[a.$number$];a:{var e=d.match(ae);if(e){b=Number(e[1]);var f=Number(e[2]);e=Number(e[3]);if(b>=0&&b<=255&&f>=0&&f<=255&&e>=0&&e<=255){b=[b,f,e];break a}}b=[]}b.length||l(Error(d+" is not a valid RGB color"));a=a.$m_stepCount$/5;f=[0,0,0];d=Math.min(Math.max(a,0),1);b=[Math.round(d*f[0]+(1-
d)*b[0]),Math.round(d*f[1]+(1-d)*b[1]),Math.round(d*f[2]+(1-d)*b[2])];d=this.$m_context$;e=b[0];f=b[1];b=b[2];e=Number(e);f=Number(f);b=Number(b);(isNaN(e)||e<0||e>255||isNaN(f)||f<0||f>255||isNaN(b)||b<0||b>255)&&l(Error('"('+e+","+f+","+b+'") is not a valid RGB color'));e=be(e.toString(16));f=be(f.toString(16));b=be(b.toString(16));d.fillStyle="#"+e+f+b;this.$m_context$.beginPath();this.$m_context$.arc(c.x,c.y,Ve*(1-0.5*a),0,2*Math.PI,s);this.$m_context$.fill()}};
function nf(a){var c=a.$m_balls$[a.$m_bombNumber$];if(c){c=c.$m_shapeList$;a.$m_bombPulseAngle$+=a.$m_bombPulseInc$;var b=a.$m_context$.createRadialGradient(c.$m_position$.x,c.$m_position$.y,0,c.$m_position$.x,c.$m_position$.y,32);b.addColorStop(0.2,"rgba(255,234,136,"+Math.abs(Math.sin(a.$m_bombPulseAngle$))+")");b.addColorStop(0.8,"rgba(255,234,136,0.0)");a.$m_context$.fillStyle=b;a.$m_context$.beginPath();a.$m_context$.arc(c.$m_position$.x,c.$m_position$.y,32,0,2*Math.PI,s);a.$m_context$.fill()}}
function qf(a,c){a.$_isBombIgnited$=s;a.$m_bombNumber$=c;a.$m_bombPulseAngle$=0;a.$m_bombPulseInc$=0.12}function lf(a){var c=0,b=0,d=Gd(a.$m_balls$);Ed(a.$m_balls$,function(e){var f=I(e.$m_linearVelocity$);if(f==0){b++;c++}else if(f<10){hf(this)||K(e.$m_linearVelocity$,new J);b++;c++}else f<20&&c++},a);if(!a.$m_isCueVisible$&&(b==d||c==d&&a.$m_balls$[0]&&I(a.$m_balls$[0].$m_linearVelocity$)==0)){a.dispatchEvent(new Q(rf,a));Qe(a)}}
function af(a,c,b){var d=new Jb;d.$radius$=7;var e=new Eb;Fb(e,d);e.position.$Set$(c,b);e.$userData$=[mf];return bd(a,e)}
var $e="table",mf="pocket",ef="ball",rf="cueStopped",Je="CUESTICK_HIT_START",Le="CUESTICK_HIT_STOP",Ue="rgb(232,208,176)",of="rgb(40,37,29)",Te="rgb(178,55,17)",pf={1:"rgb(250,164,25)",9:"rgb(250,164,25)",2:"rgb(35,45,101)",10:"rgb(35,45,101)",3:"rgb(192,66,57)",11:"rgb(192,66,57)",4:"rgb(80,46,67)",12:"rgb(80,46,67)",5:"rgb(236,89,37)",13:"rgb(236,89,37)",6:"rgb(48,65,37)",14:"rgb(48,65,37)",7:"rgb(117,36,32)",15:"rgb(117,36,32)",8:"rgb(34,34,34)",0:Ue},Ye=new V([[-1,0],[0,1]]),Ze=new V([[-1,0],
[0,-1]]),Oe=1E3/60,Me=175,Xe=-15,We=7,He=192,Ge=396,Ve=14,W=10;function sf(a){window._gaq===undefined&&(window._gaq=[]);window._gaq.push(a)}function tf(a){var c=document.createElement("script");c.type="text/javascript";c.async=o;c.src=a;a=document.getElementsByTagName("head");a.length!=1&&l(Error("Couldn't find a single head tag."));a=a[0];var b=a.getElementsByTagName("script");if(b.length==0)a.appendChild(c);else{a=b[0];a.parentNode&&a.parentNode.insertBefore(c,a)}};function uf(a){ed.call(this);this.$m_timer$=r;this.$m_bombNumber$=-1;this.$m_poolTable$=a;this.$m_bombDemoMode$=s;U(a,jd,this.$_pooltable_pocketDrop$,undefined,this);U(a,"BALL",this.$_pooltable_ballHit$,undefined,this);U(a,"CUEBALL",this.$_pooltable_ballHit$,undefined,this);U(a,"BREAK",this.$_pooltable_ballHit$,undefined,this);this.reset()}E(uf,Wd);t=uf.prototype;
t.reset=function(){if(this.$m_timer$){this.$m_timer$.$dispose$();this.$secondsLeft$=vf}this.$bombSecondsLeft$=wf+2;this.$m_bombNumber$=this.$m_bombDemoMode$?1:Math.floor(Math.random()*15)+1;this.$_isBombActive$=this.$_isBombFound$=s;bf(this.$m_poolTable$);this.$m_poolTable$.$resume$();qf(this.$m_poolTable$,-1);this.$secondsLeft$=vf;X(this,xf);this.$score$=0;X(this,yf);X(this,zf);this.$gameState$=Af;X(this,Bf)};
t.start=function(){if(this.$m_timer$){this.$m_timer$.$dispose$();this.$secondsLeft$=vf;X(this,xf)}this.$m_timer$=new Xd(1E3);this.$m_timer$.start();U(this.$m_timer$,Zd,this.$_tickAction$,undefined,this);this.$gameState$=Cf;X(this,Df)};t.pause=function(){if(this.$gameState$==Cf){this.$m_poolTable$.pause();this.$gameState$=Ef;X(this,Ff)}};t.$resume$=function(){if(this.$gameState$==Ef){this.$m_poolTable$.$resume$();this.$gameState$=Cf;X(this,Gf)}};
function Hf(a){if(!a.$_isBombFound$&&a.$m_bombNumber$ in a.$m_poolTable$.$m_balls$){a.$_isBombFound$=o;a.$_isBombActive$=o;qf(a.$m_poolTable$,a.$m_bombNumber$);X(a,If);return o}else return s}function Jf(a){if(a.$_isBombActive$){a.$_isBombActive$=s;a.$m_bombNumber$=-1;a.$secondsLeft$+=30;qf(a.$m_poolTable$,-1);X(a,Kf);return o}else return s}function fg(){var a=Hd.get("h","0");return parseInt(a,10)}
t.$_tickAction$=function(){if(this.$gameState$==Cf){this.$secondsLeft$--;if(this.$_isBombActive$){this.$bombSecondsLeft$--;X(this,Lf);if(this.$bombSecondsLeft$<=0){this.$secondsLeft$-=30;if(this.$secondsLeft$<10)this.$secondsLeft$=10;X(this,Mf);this.$_isBombActive$=s}}if(this.$secondsLeft$<=0){this.$secondsLeft$=0;Nf(this)}X(this,xf)}};function Nf(a){a.$m_timer$.stop();a.$m_poolTable$.pause();a.$gameState$=Of;X(a,Pf)}
function X(a,c){a.dispatchEvent(new Q(c,a));pb(Qf,c)>=0&&sf(["_trackEvent","game",c,void 0,void 0])}t.$_pooltable_pocketDrop$=function(a){if(a.$ballNumber$!=0){oe().info("Pocket drop: "+a.$ballNumber$);this.$score$+=100;X(this,yf);if(this.$score$>fg()){fb("h",this.$score$);X(this,zf)}}this.$_isBombFound$&&a.$ballNumber$==this.$m_bombNumber$&&Jf(this);Pe(this.$m_poolTable$)&&Nf(this)};
t.$_pooltable_ballHit$=function(a){!this.$_isBombFound$&&(a.$ballNumber1$==0&&a.$ballNumber2$==this.$m_bombNumber$||a.$ballNumber2$==0&&a.$ballNumber1$==this.$m_bombNumber$)&&Hf(this)};
var Af="ready",Cf="started",Ef="paused",Of="ended",Bf="ready",Df="start",Ff="pause",Gf="resume",Pf="end",xf="tick",yf="score",zf="highscore",If="bombactivated",Lf="bombtick",Kf="bombdeactivated",Mf="bombexploded",Qf=[Df,Ff,Gf,Pf,If,Kf,Mf,{$READY$:Bf,$START$:Df,$PAUSE$:Ff,$RESUME$:Gf,$END$:Pf,$TICK$:xf,$SCORE$:yf,$HIGHSCORE$:zf,$BOMBACTIVATED$:If,$BOMBTICK$:Lf,$BOMBDEACTIVATED$:Kf,$BOMBEXPLODED$:Mf}],vf=120,wf=30;function Rf(a,c){ed.call(this);this.$m_music$=r;this.$m_name$=a;this.$m_locations$=c;Hd.get("m",undefined)==undefined&&Sf(this)}E(Rf,Wd);function Sf(a){Tf(a);a.$m_music$=Uf(a.$m_name$,a.$m_locations$);a.$m_music$.setAttribute("loop","loop");a.$m_music$.load();a.$m_music$.play();fb("m",undefined);a.dispatchEvent(new Q(Vf))}function Wf(a){Tf(a);fb("m","0");a.dispatchEvent(new Q(Vf))}var Vf="eightball.Music.STATE_CHANGE_EVENT_TYPE";
function Tf(a){if(a.$m_music$){a.$m_music$.pause();a.$m_music$.parentNode.removeChild(a.$m_music$);a.$m_music$=r}ib(document.getElementsByClassName("audio_"+a.$m_name$),function(c){c.parentNode.removeChild(c)})};function Xf(a,c,b){this.$m_audios$=[];this.$m_maxSimul$=b;this.$m_currSimul$=0;for(var d=document.getElementsByClassName("audio_"+a),e=0;e<d.length;e++)this.$m_audios$.push(d[e]);for(d=d.length;d<b;d++)this.$m_audios$.push(Uf(a,c))}Xf.prototype.play=function(){this.$m_currSimul$++;this.$m_currSimul$%=this.$m_maxSimul$;var a=this.$m_audios$[this.$m_currSimul$];if(Oa){ib(a.getElementsByTagName("source"),function(c){c.src=c.src});a.load()}a.play();return a};
function Uf(a,c){var b=document.getElementById(Yf);if(b===undefined||b==r){b=document.createElement("div");b.id=Yf;b.style.display="none";document.body.appendChild(b)}var d=document.createElement("audio");d.className="audio_"+a;b.appendChild(d);for(var e in c){b=document.createElement("source");b.src=c[e][0];b.type=c[e][1];d.appendChild(b)}return d}var Yf="_audios";function Zf(a){ed.call(this);this.$m_sounds$={};this.$m_audioMap$=a}E(Zf,Wd);Zf.prototype.add=function(a,c){this.$m_sounds$[a]=new Xf(a,this.$m_audioMap$[a],c)};Zf.prototype.play=function(a){if($f())return this.$m_sounds$[a].play()};function $f(){return Hd.get("s",undefined)==undefined}function ag(a){var c=$f()?"0":undefined;fb("s",c);a.dispatchEvent(new Q(bg))}var bg="eightball.SoundEffectManager.STATE_CHANGE_EVENT_TYPE";var cg={$DECIMAL_SEP$:".",$GROUP_SEP$:",",$PERCENT$:"%",$ZERO_DIGIT$:"0",$PLUS_SIGN$:"+",$MINUS_SIGN$:"-",$EXP_SYMBOL$:"E",$PERMILL$:"\u2030",$INFINITY$:"\u221e",$NAN$:"NaN",$DECIMAL_PATTERN$:"#,##0.###",$SCIENTIFIC_PATTERN$:"#E0",$PERCENT_PATTERN$:"#,##0%",$CURRENCY_PATTERN$:"\u00a4#,##0.00;(\u00a4#,##0.00)",$DEF_CURRENCY_CODE$:"USD"},Z=cg;Z=cg;var dg={AED:"\u062f.\u0625",ARS:"$",AUD:"$",BDT:"\u09f3",BRL:"R$",CAD:"$",CHF:"Fr.",CLP:"$",CNY:"\u00a5",COP:"$",CRC:"\u20a1",CUP:"$",CZK:"K\u010d",DKK:"kr",DOP:"$",EGP:"\u00a3",EUR:"\u20ac",GBP:"\u00a3",HKD:"$",HRK:"kn",HUF:"Ft",IDR:"Rp",ILS:"\u20aa",INR:"Rs",IQD:"\u0639\u062f",ISK:"kr",JMD:"$",JPY:"\u00a5",KRW:"\u20a9",KWD:"\u062f.\u0643",LKR:"Rs",LVL:"Ls",MNT:"\u20ae",MXN:"$",MYR:"RM",NOK:"kr",NZD:"$",PAB:"B/.",PEN:"S/.",PHP:"P",PKR:"Rs.",PLN:"z\u0142",RON:"L",RUB:"\u0440\u0443\u0431",SAR:"\u0633.\u0631",
SEK:"kr",SGD:"$",SKK:"Sk",SYP:"SYP",THB:"\u0e3f",TRY:"TL",TWD:"NT$",USD:"$",UYU:"$",VEF:"Bs.F",VND:"\u20ab",XAF:"FCFA",XCD:"$",YER:"YER",ZAR:"R"};function eg(){this.$intlCurrencyCode_$=Z.$DEF_CURRENCY_CODE$;this.$currencySymbol_$=dg[this.$intlCurrencyCode_$];this.$maximumIntegerDigits_$=40;this.$minimumIntegerDigits_$=1;this.$maximumFractionDigits_$=3;this.$minExponentDigits_$=this.$minimumFractionDigits_$=0;this.$positiveSuffix_$=this.$positivePrefix_$="";this.$negativePrefix_$="-";this.$negativeSuffix_$="";this.$multiplier_$=1;this.$groupingSize_$=3;this.$useExponentialNotation_$=this.$decimalSeparatorAlwaysShown_$=s;this.$pattern_$="#,###.##".replace(/ /g,
"\u00a0");var a=[0];this.$positivePrefix_$=gg(this,"#,###.##",a);for(var c=a[0],b=-1,d=0,e=0,f=0,g=-1,h=o;a[0]<8&&h;a[0]++)switch("#,###.##".charAt(a[0])){case "#":if(e>0)f++;else d++;g>=0&&b<0&&g++;break;case "0":f>0&&l(Error('Unexpected "0" in pattern "#,###.##"'));e++;g>=0&&b<0&&g++;break;case ",":g=0;break;case ".":b>=0&&l(Error('Multiple decimal separators in pattern "#,###.##"'));b=d+e+f;break;case "E":this.$useExponentialNotation_$&&l(Error('Multiple exponential symbols in pattern "#,###.##"'));
this.$useExponentialNotation_$=o;for(this.$minExponentDigits_$=0;a[0]+1<8&&"#,###.##".charAt(a[0]+1)=="0";){a[0]++;this.$minExponentDigits_$++}(d+e<1||this.$minExponentDigits_$<1)&&l(Error('Malformed exponential pattern "#,###.##"'));h=s;break;default:a[0]--;h=s}if(e==0&&d>0&&b>=0){e=b;e==0&&e++;f=d-e;d=e-1;e=1}(b<0&&f>0||b>=0&&(b<d||b>d+e)||g==0)&&l(Error('Malformed pattern "#,###.##"'));f=d+e+f;this.$maximumFractionDigits_$=b>=0?f-b:0;if(b>=0){this.$minimumFractionDigits_$=d+e-b;if(this.$minimumFractionDigits_$<
0)this.$minimumFractionDigits_$=0}this.$minimumIntegerDigits_$=(b>=0?b:f)-d;if(this.$useExponentialNotation_$){this.$maximumIntegerDigits_$=d+this.$minimumIntegerDigits_$;if(this.$maximumFractionDigits_$==0&&this.$minimumIntegerDigits_$==0)this.$minimumIntegerDigits_$=1}this.$groupingSize_$=Math.max(0,g);this.$decimalSeparatorAlwaysShown_$=b==0||b==f;c=a[0]-c;this.$positiveSuffix_$=gg(this,"#,###.##",a);if(a[0]<8&&"#,###.##".charAt(a[0])==hg){a[0]++;this.$negativePrefix_$=gg(this,"#,###.##",a);a[0]+=
c;this.$negativeSuffix_$=gg(this,"#,###.##",a)}else{this.$negativePrefix_$=this.$positivePrefix_$+this.$negativePrefix_$;this.$negativeSuffix_$+=this.$positiveSuffix_$}}
function ig(a,c,b,d){var e=Math.pow(10,a.$maximumFractionDigits_$);c=Math.round(c*e);var f=Math.floor(c/e),g=Math.floor(c-f*e),h=a.$minimumFractionDigits_$>0||g>0,j="";for(c=f;c>1.0E20;){j="0"+j;c=Math.round(c/10)}j=c+j;var i=Z.$DECIMAL_SEP$,k=Z.$GROUP_SEP$;c=Z.$ZERO_DIGIT$.charCodeAt(0);var n=j.length;if(f>0||b>0){for(f=n;f<b;f++)d.push(Z.$ZERO_DIGIT$);for(f=0;f<n;f++){d.push(String.fromCharCode(c+j.charAt(f)*1));n-f>1&&a.$groupingSize_$>0&&(n-f)%a.$groupingSize_$==1&&d.push(k)}}else h||d.push(Z.$ZERO_DIGIT$);
(a.$decimalSeparatorAlwaysShown_$||h)&&d.push(i);b=""+(g+e);for(e=b.length;b.charAt(e-1)=="0"&&e>a.$minimumFractionDigits_$+1;)e--;for(f=1;f<e;f++)d.push(String.fromCharCode(c+b.charAt(f)*1))}function jg(a,c,b){b.push(Z.$EXP_SYMBOL$);if(c<0){c=-c;b.push(Z.$MINUS_SIGN$)}c=""+c;for(var d=c.length;d<a.$minExponentDigits_$;d++)b.push(Z.$ZERO_DIGIT$);b.push(c)}var hg=";";
function gg(a,c,b){for(var d="",e=s,f=c.length;b[0]<f;b[0]++){var g=c.charAt(b[0]);if(g=="'")if(b[0]+1<f&&c.charAt(b[0]+1)=="'"){b[0]++;d+="'"}else e=!e;else if(e)d+=g;else switch(g){case "#":case "0":case ",":case ".":case hg:return d;case "\u00a4":if(b[0]+1<f&&c.charAt(b[0]+1)=="\u00a4"){b[0]++;d+=a.$intlCurrencyCode_$}else d+=a.$currencySymbol_$;break;case "%":a.$multiplier_$!=1&&l(Error("Too many percent/permill"));a.$multiplier_$=100;d+=Z.$PERCENT$;break;case "\u2030":a.$multiplier_$!=1&&l(Error("Too many percent/permill"));
a.$multiplier_$=1E3;d+=Z.$PERMILL$;break;default:d+=g}}return d};function zg(){var a=Array.prototype.slice.call(arguments),c=a.shift();typeof c=="undefined"&&l(Error("[goog.string.format] Template required"));return c.replace(/%([0\-\ \+]*)(\d+)?(\.(\d+))?([%sfdiu])/g,function(b,d,e,f,g,h){if(h=="%")return"%";var j=a.shift();typeof j=="undefined"&&l(Error("[goog.string.format] Not enough arguments"));arguments[0]=j;return Ag[h].apply(r,arguments)})}var Ag={};
Ag.s=function(a,c,b){if(isNaN(b)||a.length>=b)return a;if(c.indexOf("-",0)>-1)a+=Array(b-a.length+1).join(" ");else a=Array(b-a.length+1).join(" ")+a;return a};
Ag.f=function(a,c,b,d,e){d=a.toString();isNaN(e)||e==""||(d=a.toFixed(e));var f;f=a<0?"-":c.indexOf("+")>=0?"+":c.indexOf(" ")>=0?" ":"";a>=0&&(d=f+d);if(isNaN(b)||d.length>=b)return d;d=isNaN(e)?Math.abs(a).toString():Math.abs(a).toFixed(e);a=b-d.length-f.length;return d=c.indexOf("-",0)>=0?f+d+Array(a+1).join(" "):f+Array(a+1).join(c.indexOf("0",0)>=0?"0":" ")+d};Ag.d=function(a,c,b,d,e,f,g,h){return Ag.f(parseInt(a,10),c,b,d,0,f,g,h)};Ag.i=Ag.d;Ag.u=Ag.d;var kg={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"caps-lock",27:"esc",32:"space",33:"pg-up",34:"pg-down",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",61:"equals",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",93:"context",96:"num-0",
97:"num-1",98:"num-2",99:"num-3",100:"num-4",101:"num-5",102:"num-6",103:"num-7",104:"num-8",105:"num-9",106:"num-multiply",107:"num-plus",109:"num-minus",110:"num-period",111:"num-division",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",187:"equals",188:",",190:".",191:"/",220:"\\",224:"win"};function lg(a){ed.call(this);this.$shortcuts_$={};this.$lastKeys_$={$strokes$:[],$time$:0};this.$globalKeys_$=Ld(mg);this.$alwaysPreventDefault_$=o;this.$allShortcutsAreGlobal_$=this.$alwaysStopPropagation_$=s;this.$modifierShortcutsAreGlobal_$=o;this.$keyTarget_$=a;U(this.$keyTarget_$,"keydown",this.$handleKeyDown_$,s,this);Ha&&Na&&$a("1.8")&&U(this.$keyTarget_$,"keyup",this.$handleMacGeckoKeyUp_$,s,this);if(Ra&&!Na){U(this.$keyTarget_$,"keypress",this.$handleWindowsKeyPress_$,s,this);U(this.$keyTarget_$,
"keyup",this.$handleWindowsKeyUp_$,s,this)}}var ng;E(lg,Wd);var mg=[27,112,113,114,115,116,117,118,119,120,121,122,123,19],og={$SHORTCUT_TRIGGERED$:"shortcut",$SHORTCUT_PREFIX$:"shortcut_"};t=lg.prototype;
t.$registerShortcut$=function(a){var c=pg,b=this.$shortcuts_$,d=arguments;if(D(d[1])){d=d[1];d=d.replace(/[ +]*\+[ +]*/g,"+").replace(/[ ]+/g," ").toLowerCase();d=d.split(" ");for(var e=[],f,g=0;f=d[g];g++){var h=f.split("+"),j;f=0;for(var i,k=0;i=h[k];k++){switch(i){case "shift":f|=1;continue;case "ctrl":f|=2;continue;case "alt":f|=4;continue;case "meta":f|=8;continue}j=i;if(!ng){h={};i=void 0;for(i in kg)h[kg[i]]=i;ng=h}j=ng[j];break}e.push({keyCode:j,$modifiers$:f})}d=e}else{e=d;g=1;if(ga(d[1])){e=
d[1];g=0}for(d=[];g<e.length;g+=2)d.push({keyCode:e[g],$modifiers$:e[g+1]})}c(b,d,a)};t.$disposeInternal$=function(){lg.$superClass_$.$disposeInternal$.call(this);this.$shortcuts_$={};Qd(this.$keyTarget_$,"keydown",this.$handleKeyDown_$,s,this);Ha&&Na&&$a("1.8")&&Qd(this.$keyTarget_$,"keyup",this.$handleMacGeckoKeyUp_$,s,this);if(Ra&&!Na){Qd(this.$keyTarget_$,"keypress",this.$handleWindowsKeyPress_$,s,this);Qd(this.$keyTarget_$,"keyup",this.$handleWindowsKeyUp_$,s,this)}this.$keyTarget_$=r};
t.$handleMacGeckoKeyUp_$=function(a){if(a.keyCode==224){this.$metaKeyRecentlyReleased_$=o;$d(function(){this.$metaKeyRecentlyReleased_$=s},this)}else{var c=a.metaKey||this.$metaKeyRecentlyReleased_$;if((a.keyCode==67||a.keyCode==88||a.keyCode==86)&&c){a.metaKey=c;this.$handleKeyDown_$(a)}}};function qg(a){return Ra&&!Na&&a.ctrlKey&&a.altKey&&!a.shiftKey}t.$handleWindowsKeyPress_$=function(a){if(a.keyCode>32&&qg(a))this.$isPrintableKey_$=o};
t.$handleWindowsKeyUp_$=function(a){!this.$isPrintableKey_$&&qg(a)&&this.$handleKeyDown_$(a)};function pg(a,c,b){var d=c.shift();d=d.keyCode&255|d.$modifiers$<<8;var e=a[d];e&&b&&(c.length==0||D(e))&&l(Error("Keyboard shortcut conflicts with existing shortcut"));if(c.length){e||(e=a[d]={});pg(e,c,b)}else a[d]=b}function rg(a,c,b,d){b=b||0;if((d=(d||a.$shortcuts_$)[c[b]])&&!D(d)&&c.length-b>1)return rg(a,c,b+1,d);return d}
t.$handleKeyDown_$=function(a){if(sg(this,a))if(a.type=="keydown"&&qg(a))this.$isPrintableKey_$=s;else{var c=a.keyCode&255|((a.shiftKey?1:0)|(a.ctrlKey?2:0)|(a.altKey?4:0)|(a.metaKey?8:0))<<8,b,d,e=ra();if(this.$lastKeys_$.$strokes$.length&&e-this.$lastKeys_$.$time$<=1500)b=rg(this,this.$lastKeys_$.$strokes$);else this.$lastKeys_$.$strokes$.length=0;b=b?b[c]:this.$shortcuts_$[c];if(!b){b=this.$shortcuts_$[c];this.$lastKeys_$.$strokes$=[]}if(b&&D(b))d=b;else if(b){this.$lastKeys_$.$strokes$.push(c);
this.$lastKeys_$.$time$=e;Na&&a.preventDefault()}else this.$lastKeys_$.$strokes$.length=0;if(d){this.$alwaysPreventDefault_$&&a.preventDefault();this.$alwaysStopPropagation_$&&a.stopPropagation();b=a.target;c=this.dispatchEvent(new tg(og.$SHORTCUT_TRIGGERED$,d,b));d=new tg(og.$SHORTCUT_PREFIX$+d,d,b);c&=this.dispatchEvent(d);c||a.preventDefault();this.$lastKeys_$.$strokes$.length=0}}};
function sg(a,c){var b=c.keyCode;if(b==16||b==17||b==18)return s;var d=c.target,e=d.tagName=="TEXTAREA"||d.tagName=="INPUT"||d.tagName=="BUTTON"||d.tagName=="SELECT",f=!e&&(d.isContentEditable||d.ownerDocument&&d.ownerDocument.designMode=="on");if(!e&&!f)return o;if(a.$globalKeys_$[b]||a.$allShortcutsAreGlobal_$)return o;if(f)return s;if(a.$modifierShortcutsAreGlobal_$&&(c.altKey||c.ctrlKey||c.metaKey))return o;if(d.tagName=="INPUT"&&(d.type=="text"||d.type=="password"))return b==13;if(d.tagName==
"INPUT"||d.tagName=="BUTTON")return b!=32;return s}function tg(a,c,b){Q.call(this,a,b);this.identifier=c}E(tg,Q);function ug(a){ed.call(this);this.$m_shortcutHandler$=new lg(document);this.$m_map$=[];this.$m_useStyles$=!a;U(this.$m_shortcutHandler$,"shortcut",pa(this.$_handleKey$,this))}E(ug,Wd);ug.prototype.add=function(a,c,b){this.$m_shortcutHandler$.$registerShortcut$(this.$m_map$.length.toString(),a);this.$m_map$.push({keybinding:a,description:c,action:b})};
ug.prototype.$_handleKey$=function(a){var c=this.$m_map$[new Number(a.identifier)],b=c.action.call();a.stopPropagation();this.dispatchEvent(new vg(c.keybinding,b||c.description))};function vg(a,c){Q.call(this,"KeyBindingEvent");this.$keybinding$=a;this.description=c}E(vg,Q);function wg(){function a(){w.pause();g.fadeIn(400);i.fadeIn(400);(m=e.$m_music$!=r)&&Wf(e)}function c(){var y=$(window).width(),p=$(window).height();z.$m_cueCanvasContext$.canvas.width=y;z.$m_cueCanvasContext$.canvas.height=p;Fe(z)}function b(){$f()?$("#soundsbutton .on").fadeIn(200):$("#soundsbutton .on").fadeOut(200)}function d(){e.$m_music$!=r?$("#musicbutton .on").fadeIn(200):$("#musicbutton .on").fadeOut(200)}if(window.doStats){tf("http://www.google-analytics.com/ga.js");sf(["_setAccount","UA-18513960-1"]);
sf(["_trackPageview"]);C.sc_project=6221324;C.sc_security="0296de03";C.sc_invisible=1;tf("http://www.statcounter.com/counter/counter_xhtml.js")}this.$m_lastTickSeconds$=0;this.$m_lastBars$=29;Ha&&$("#timers .digit").css("line-height","62px");$("#vignette").delay(500).fadeIn(1E3);$("#game").delay(500).fadeIn(1E3);$("#gamecontrolsdisplay").delay(500).fadeIn(1E3,function(){d();b()});$("#gamecontrolsclick").show();$("#cue_canvas").show();var e=new Rf("theme",preloadAssets.audios.theme);U(e,Vf,d);var f=
new Zf(preloadAssets.audios);U(f,bg,b);f.add("activate",1);f.add("ball",5);f.add("bombtick",1);f.add("bombtickfast",1);f.add("bombtickslow",1);f.add("break",1);f.add("cuehit",1);f.add("cuestick",1);f.add("deactivate",1);f.add("explode",1);f.add("pocket",2);f.add("quietball",2);f.add("quietwall",2);f.add("typing",1);f.add("wall",3);var g=$("#overlay"),h=$("#start"),j=$("#startmessage"),i=$("#resume"),k=$("#gameover"),n=s,m=s,q=s,x=r,z=new Ee($("canvas#demo_canvas")[0],$("canvas#cue_canvas")[0],preloadAssets.images);
this.$m_poolTable$=z;var w=new uf(z);this.$m_game$=w;U(w,xf,function(){n||xg(this,w.$secondsLeft$);Vg();if(this.$m_game$.$gameState$==Cf){var y;y=new eg;var p=this.$m_poolTable$.$m_fpsLogger$.$m_fps$;if(isNaN(p))y=Z.$NAN$;else{var v=[],B=p<0||p==0&&1/p<0;v.push(B?y.$negativePrefix_$:y.$positivePrefix_$);if(isFinite(p)){p*=B?-1:1;p*=y.$multiplier_$;if(y.$useExponentialNotation_$)if(p==0){ig(y,p,y.$minimumIntegerDigits_$,v);jg(y,0,v)}else{var A=Math.floor(Math.log(p)/Math.log(10));p/=Math.pow(10,A);
var H=y.$minimumIntegerDigits_$;if(y.$maximumIntegerDigits_$>1&&y.$maximumIntegerDigits_$>y.$minimumIntegerDigits_$){for(;A%y.$maximumIntegerDigits_$!=0;){p*=10;A--}H=1}else if(y.$minimumIntegerDigits_$<1){A++;p/=10}else{A-=y.$minimumIntegerDigits_$-1;p*=Math.pow(10,y.$minimumIntegerDigits_$-1)}ig(y,p,H,v);jg(y,A,v)}else ig(y,p,y.$minimumIntegerDigits_$,v)}else v.push(Z.$INFINITY$);v.push(B?y.$negativeSuffix_$:y.$positiveSuffix_$);y=v.join("")}oe().info("FPS: "+y)}},s,this);U(w,yf,function(){var y=
w.$score$;y==0&&(y="00");$("#score").html(y);$("#gameoverscore").html(y)});U(w,zf,function(){$("#bestscore").html(fg())});U(w,Bf,function(){g.fadeIn(1E3);$("#bombicon").hide();$("#bombsecondstens").hide();$("#bombsecondsones").hide();$("#boom").hide();var y=0;h.delay(800).fadeIn(400,function(){if(!q){x=f.play("typing");var p=setInterval(function(){j.html("Mission #1146<br/>To: Agent 008<br/>From: Cue<br/><br/><br/>The International Billiards Tournament is being infil- trated by the terrorist organization CHALK.<br/><br/>Do not let them win! Sink as  many balls as possible before the timer runs out.".substr(0,
y));y++;if(y>247){clearInterval(p);x&&x.pause()}},10)}})});U(w,Pf,function(){g.fadeIn(500);k.fadeIn(400)});U(w,If,function(){$("#bombicon").fadeIn(200);$("#bombsecondstens").fadeIn(200);$("#bombsecondsones").fadeIn(200);f.play("activate")});U(w,Lf,function(){var y=w.$bombSecondsLeft$%60;y>30&&(y=30);var p=Math.floor(y/10),v=y%10;$("#bombsecondstens").html(String(p));$("#bombsecondsones").html(String(v));if(y>19)f.play("bombtickslow");else if(y<=10)f.play("bombtickfast");else y>=1&&f.play("bombtick");
if(y==19||y==10)z.$m_bombPulseInc$+=0.12});U(w,Kf,function(){f.play("deactivate");$("#bombicon").fadeOut(1200);$("#bombsecondstens").fadeOut(1200);$("#bombsecondsones").fadeOut(1200);var y=this.$m_lastTickSeconds$,p=setInterval(pa(function(){if(y>=w.$secondsLeft$){clearInterval(p);n=s}else{y++;xg(this,y)}},this),50)},s,this);U(w,Mf,function(){f.play("explode");z.$_isBombIgnited$=o;$("#bombicon").fadeOut(1200);$("#bombsecondstens").fadeOut(1200);$("#bombsecondsones").fadeOut(1200);setTimeout(function(){var v;
if(v=z.$m_balls$[z.$m_bombNumber$]){var B=new vb(Ge,He);v=v.$m_position$.$Copy$().add(B)}else v=r;if(v){ff(z);$("#boom").css("left",v.x).css("top",v.y).show()}},1500);n=o;var y=this.$m_lastTickSeconds$,p=setInterval(function(){if(y<w.$secondsLeft$){clearInterval(p);n=s}else y--},50)},s,this);U(z,Je,function(){$("#gamecontrolsclick").hide()});U(z,Le,function(){$("#gamecontrolsclick").show()});U(z,"CUESTICK",function(){f.play("cuestick")});U(z,"BREAK",function(){f.play("break")});U(z,"CUEBALL",function(){f.play("cuehit")});
U(z,"BALL",function(y){oe().info("velocity: "+y.$velocity$);if(y.$velocity$>80)f.play("ball");else y.$velocity$>20&&f.play("quietball")});U(z,"WALL",function(y){if(y.$velocity$>120)f.play("wall");else y.$velocity$>40&&f.play("quietwall")});U(z,jd,function(){f.play("pocket")});w.reset();$(window).resize(c);c();var u=new ug;U(u,"KeyBindingEvent",function(y){$("#alert-div-holder").stop(o,o).show();if(y.$keybinding$=="h"){y=u.$m_map$;var p=$("<table>");ib(y,function(v){var B=$("<tr>");B.append($("<td>"+
v.keybinding+"</td>"));B.append($("<td>"+v.description+"</td>"));p.append(B)});$("#alert-div").html("").append(p);$("#alert-div-holder").delay(4E3).fadeOut(500)}else{$("#alert-div").text(y.description);$("#alert-div-holder").delay(2E3).fadeOut(500)}});u.add("a","Activate bomb",function(){return Hf(w)?"Bomb activated":"No-op"});u.add("b","Bomb demo mode",function(){w.$m_bombDemoMode$=o;w.reset()});u.add("d","Deactivate bomb",function(){return Jf(w)?"Bomb deactivated":"No-op"});u.add("e","End game early",
function(){if(w.$gameState$==Cf)w.$secondsLeft$=2});u.add("f","No Gravity",function(){hf(z,s)});u.add("g","Gravity",function(){hf(z,o)});u.add("h","Help",ea);u.add("i","Toggle framerate throttling",function(){if(z.$_timer$.$interval_$==Oe){Xg(z,s);return"Framerate: floating"}else{Xg(z,o);return"Framerate: fixed"}});u.add("l","Toggle debug log",function(){var y;if(Ug){if(Ug){Ug&&Ug.parentNode&&Ug.parentNode.removeChild(Ug);Ug=r;(y=oe().$handlers_$)&&Jg(y,Wg)}y=s}else{if(!Ug){y=Ug=Qg("div",{id:"_debugLogDiv",
style:"display:block; position:absolute; top:7px; right:7px; padding:10px; width:300px; background: rgba(0,0,0,.4); color:yellowgreen; text-align:left; font-family:monospace; border:solid 1px black; z-index:9999;"});document.body.appendChild(y);y=oe();if(!y.$handlers_$)y.$handlers_$=[];y.$handlers_$.push(Wg)}y=o}return y?"Logger on":"Logger off"});u.add("m","Toggle music",function(){e.$m_music$!=r?Wf(e):Sf(e);return"Game music is now "+(e.$m_music$!=r?"on":"off")});u.add("o","Play random sound effect",
function(){var y=f.$m_sounds$,p=[],v=0,B;for(B in y)p[v++]=B;y=Math.floor(Math.random()*p.length);f.play(p[y]);return"Playing "+p[y]});u.add("p","Pause game",a);u.add("r","Restart game",function(){w.reset()});u.add("s","Toggle sound",function(){ag(f);return"Game sounds are now "+($f()?"on":"off")});u.add("x","Detonate bomb",function(){var y;if(w.$_isBombActive$){w.$bombSecondsLeft$=Math.min(2,w.$bombSecondsLeft$);y=o}else y=s;return y?"Bomb detonated":"No-op"});k.click(function(){k.fadeOut(400);w.reset()});
$("#startoverclick").click(function(){w.reset()});h.click(function(){h.fadeOut(100);g.fadeOut(400);w.start();q=o;x&&x.pause();j.html("Mission #1146<br/>To: Agent 008<br/>From: Cue<br/><br/><br/>The International Billiards Tournament is being infil- trated by the terrorist organization CHALK.<br/><br/>Do not let them win! Sink as  many balls as possible before the timer runs out.")});$("#pauseclick").click(a);i.click(function(){g.fadeOut(400);i.fadeOut(400,function(){w.$resume$()});m&&Sf(e)});$("#gameoverfacebook").click(function(y){y.stopPropagation();
window.open(Bg(w.$score$))});$("#gameovertwitter").click(function(y){y.stopPropagation();window.open(Cg(w.$score$))});$("#instructionsclick").click(function(){w.pause();g.fadeIn(500);$("#howtoplay").fadeIn(200);$("#cue_canvas").hide()});$("#howtoplay").click(function(){w.$resume$();g.fadeOut(200);$("#howtoplay").fadeOut(200);$("#cue_canvas").show()});$("#musicbuttonclick").click(function(){e.$m_music$!=r?Wf(e):Sf(e)});$("#soundsbuttonclick").click(function(){ag(f)});Yg()}
function xg(a,c){a.$m_lastTickSeconds$=c;var b=Math.floor(c/60),d=c%60,e=Math.floor(d/10);d%=10;$("#minutesremaining").html(b.toString());$("#secondsremainingtens").html(e.toString());$("#secondsremainingones").html(d.toString());b=1+Math.floor((c-1)/4);if(b!=a.$m_lastBars$){a.$m_lastBars$=b;$("#progress").width(Math.min(7*b,210))}}function Bg(a){a=zg(Dg,a);return zg(Eg,escape(Fg),escape(a))}function Cg(a){a=zg(Gg,a,Fg);return zg(Hg,escape(a))}
function Yg(){if(Ra){var a="Hey there! ",c=s,b=navigator.userAgent.indexOf("Windows NT 6")!=-1,d=s,e=s,f=s,g=s,h=s,j=s,i=0,k;if(k=/MSIE (\d+\.\d+)/.exec(navigator.userAgent)){e=o;i=parseFloat(k[1])}else if(k=/Firefox\/(\d+\.\d+)/.exec(navigator.userAgent)){j=o;i=parseFloat(k[1])}else if(k=/Chrome\/(\d+\.\d+)/.exec(navigator.userAgent)){f=o;i=parseFloat(k[1])}else if(k=/Opera.*Version\/(\d+\.\d+)/.exec(navigator.userAgent)){g=o;i=parseFloat(k[1])}else if(k=/Version\/(\d+\.\d+).*Safari/.exec(navigator.userAgent)){h=
o;i=parseFloat(k[1])}if(e&&i>=9)c=d=o;f&&i>=7&&(c=o);g&&i>=10&&(c=o);h&&i>=5&&(c=o);j&&i>=4&&(c=o);if(b)if(e&&!d)a+='You\'re using an older version of Internet Explorer. You should upgrade to <a target="_blank" href="http://beautyoftheweb.com">Internet Explorer 9</a> so you can start playing the game!';else if(d)return;else if(!e&&!c)a+='Looks like you\'re using an older browser. You should upgrade to <a target="_blank" href="http://beautyoftheweb.com">Internet Explorer 9</a> to get the best experience playing the game!';
else!e&&c&&(a+='If you like Agent 008 Ball now, you\'ll love it with the blazing fast graphics in <a target="_blank" target="_blank" href="http://beautyoftheweb.com">Internet Explorer 9</a>. You should <a target="_blank" href="http://beautyoftheweb.com">check it out</a>!');else if(e&&!d)a+='You\'re using an older version of Internet Explorer. You should upgrade to <a target="_blank" href="http://beautyoftheweb.com">Internet Explorer 9</a> so you can start playing the game!';else if(!e&&!c)a+='Looks like you\'re using an older browser. You should check out <a target="_blank" href="http://beautyoftheweb.com">Internet Explorer 9</a> for Windows Vista and Windows 7.';
else!e&&c&&(a+='Agent 008 Ball works best with <a target="_blank" href="http://beautyoftheweb.com">Internet Explorer 9</a> for Windows Vista and Windows 7. You should <a target="_blank" href="http://beautyoftheweb.com">check it out</a>!');$("body #browsermessage").html(a);$("#bottombar").delay(1E3).fadeIn(500);$("#bottombar-close").click(function(){$("#bottombar").fadeOut(500)})}}
var Eg="http://www.facebook.com/sharer.php?u=%s&t=%s",Dg="I just scored %d points on Agent 008 Ball!",Hg="http://twitter.com/home?status=%s",Gg="Hey @agent8ball! I just scored %d points on %s. Beat that!",Fg="http://agent8ball.com";function yg(a,c,b){var d=0,e=Gd(a),f=s;$(document).ready(function(){var g=document.createElement("div");$(g).css({height:"0px",width:"0px",overflow:"hidden"});for(var h in a){var j=$("<img></img>");$(j).unbind("load");$(j).bind("load",function(){d++;c(d/e);if(d==e){b();f=o}});$(j).attr("src",a[h]);$(g).append(j)}setTimeout(function(){f||b()},3E4)})};$(document).ready(function(){$("body").each(function(){this.onselectstart=ca(s);this.unselectable="on"});var a=preloadAssets.images;$("#loadingbg").delay(500).fadeIn(700);Ed(preloadAssets.audios,function(c,b){Uf(b,c)});yg(a,function(c){$("#loadingpg").width(237*c)},function(){$("#loadingbg").delay(500).fadeOut(700,function(){new wg})})});
